<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[GCDè¯¦è§£]]></title>
    <url>%2F2017%2F11%2F21%2FGCD%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[GCDï¼ˆGrand Central Dispatchï¼‰ ä»‹ç»GCDå±äºç³»ç»Ÿçº§çš„çº¿ç¨‹ç®¡ç†ï¼Œåœ¨Dispatch queueä¸­æ‰§è¡Œéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ€§èƒ½éå¸¸çš„é«˜ã€‚GCDè¿™å—å·²ç»å¼€æºï¼Œåœ°å€http://libdispatch.macosforge.orgã€‚GCDä¸­çš„FIFOé˜Ÿåˆ—ç§°ä¸ºdispatch queueï¼Œç”¨æ¥ä¿è¯å…ˆè¿›æ¥çš„ä»»åŠ¡å…ˆå¾—åˆ°æ‰§è¡Œã€‚ GCDæ¦‚è¦ å’Œoperation queueä¸€æ ·éƒ½æ˜¯åŸºäºé˜Ÿåˆ—çš„å¹¶å‘ç¼–ç¨‹APIï¼Œä»–ä»¬é€šè¿‡é›†ä¸­ç®¡ç†å¤§å®¶ååŒä½¿ç”¨çš„çº¿ç¨‹æ± ã€‚ å…¬å¼€çš„5ä¸ªä¸åŒé˜Ÿåˆ—ï¼šè¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­çš„main queueï¼Œ3ä¸ªä¸åŒä¼˜å…ˆçº§çš„åå°é˜Ÿåˆ—ï¼ˆHigh Priority Queueï¼ŒDefault Priority Queueï¼ŒLow Priority Queueï¼‰ï¼Œä»¥åŠä¸€ä¸ªä¼˜å…ˆçº§æ›´ä½çš„åå°é˜Ÿåˆ—Background Priority Queueï¼ˆç”¨äºI/Oï¼‰ å¯åˆ›å»ºè‡ªå®šä¹‰é˜Ÿåˆ—ï¼šä¸²è¡Œæˆ–å¹¶åˆ—é˜Ÿåˆ—ã€‚è‡ªå®šä¹‰ä¸€èˆ¬æ”¾åœ¨Default Priority Queueå’ŒMain Queueé‡Œã€‚ æ“ä½œæ˜¯åœ¨å¤šçº¿ç¨‹ä¸Šè¿˜æ˜¯å•çº¿ç¨‹ä¸»è¦æ˜¯çœ‹é˜Ÿåˆ—çš„ç±»å‹å’Œæ‰§è¡Œæ–¹æ³•ï¼Œå¹¶è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œæ‰èƒ½åœ¨å¤šçº¿ç¨‹ï¼Œå¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œå°±åªä¼šåœ¨è¿™ä¸ªå¹¶è¡Œé˜Ÿåˆ—åœ¨é˜Ÿåˆ—ä¸­è¢«åˆ†é…çš„é‚£ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚ åŸºæœ¬æ¦‚å¿µ ç³»ç»Ÿæ ‡å‡†ä¸¤ä¸ªé˜Ÿåˆ— 1234//å…¨å±€é˜Ÿåˆ—ï¼Œä¸€ä¸ªå¹¶è¡Œçš„é˜Ÿåˆ—dispatch_get_global_queue//ä¸»é˜Ÿåˆ—ï¼Œä¸»çº¿ç¨‹ä¸­çš„å”¯ä¸€é˜Ÿåˆ—ï¼Œä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—dispatch_get_main_queue è‡ªå®šä¹‰é˜Ÿåˆ— 1234//ä¸²è¡Œé˜Ÿåˆ—dispatch_queue_create(&quot;com.starming.serialqueue&quot;, DISPATCH_QUEUE_SERIAL)//å¹¶è¡Œé˜Ÿåˆ—dispatch_queue_create(&quot;com.starming.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT) åŒæ­¥å¼‚æ­¥çº¿ç¨‹åˆ›å»º 1234//åŒæ­¥çº¿ç¨‹dispatch_sync(..., ^(block))//å¼‚æ­¥çº¿ç¨‹dispatch_async(..., ^(block)) é˜Ÿåˆ—ï¼ˆdispatch queueï¼‰ Serialï¼šåˆå«private dispatch queuesï¼ŒåŒæ—¶åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚Serial queueå¸¸ç”¨äºåŒæ­¥è®¿é—®ç‰¹å®šçš„èµ„æºæˆ–æ•°æ®ã€‚å½“ä½ åˆ›å»ºå¤šä¸ªSerial queueæ—¶ï¼Œè™½ç„¶å„è‡ªæ˜¯åŒæ­¥ï¼Œä½†serial queueä¹‹é—´æ˜¯å¹¶å‘æ‰§è¡Œã€‚ Main dispatch queueï¼šå…¨å±€å¯ç”¨çš„serial queueï¼Œåœ¨åº”ç”¨ç¨‹åºä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œä»»åŠ¡ã€‚ Concurrentï¼šåˆå«global dispatch queueï¼Œå¯ä»¥å¹¶å‘çš„æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œä½†æ‰§è¡Œå®Œæˆé¡ºåºæ˜¯éšæœºçš„ã€‚ç³»ç»Ÿæä¾›å››ä¸ªå…¨å±€å¹¶å‘é˜Ÿåˆ—ï¼Œè¿™å››ä¸ªé˜Ÿåˆ—æœ‰è¿™å¯¹åº”çš„ä¼˜å…ˆçº§ï¼Œç”¨æˆ·æ˜¯ä¸èƒ½å¤Ÿåˆ›å»ºå…¨å±€é˜Ÿåˆ—çš„ï¼Œåªèƒ½è·å–ã€‚ 12dipatch_queue_t queue;queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,0); user create queueï¼šåˆ›å»ºè‡ªå·±å®šä¹‰çš„é˜Ÿåˆ—ï¼Œå¯ä»¥ç”¨dispatch_queue_createå‡½æ•°ï¼Œå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè‡ªå®šä¹‰çš„é˜Ÿåˆ—åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é˜Ÿåˆ—ç±»å‹ï¼Œé»˜è®¤NULLæˆ–è€…DISPATCH_QUEUE_SERIALçš„æ˜¯ä¸²è¡Œï¼Œå‚æ•°ä¸ºDISPATCH_QUEUE_CONCURRENTä¸ºå¹¶è¡Œé˜Ÿåˆ—ã€‚ 12dispatch_queue_t queuequeue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT); è‡ªå®šä¹‰é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ï¼šå¯ä»¥é€šè¿‡dipatch_queue_attr_make_with_qos_classæˆ–dispatch_set_target_queueæ–¹æ³•è®¾ç½®é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ 12345678//dipatch_queue_attr_make_with_qos_classdispatch_queue_attr_t attr = dispatch_queue_attr_make_with_qos_class(DISPATCH_QUEUE_SERIAL, QOS_CLASS_UTILITY, -1);dispatch_queue_t queue = dispatch_queue_create(&quot;com.starming.gcddemo.qosqueue&quot;, attr);//dispatch_set_target_queuedispatch_queue_t queue = dispatch_queue_create(&quot;com.starming.gcddemo.settargetqueue&quot;,NULL); //éœ€è¦è®¾ç½®ä¼˜å…ˆçº§çš„queuedispatch_queue_t referQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0); //å‚è€ƒä¼˜å…ˆçº§dispatch_set_target_queue(queue, referQueue); //è®¾ç½®queueå’ŒreferQueueçš„ä¼˜å…ˆçº§ä¸€æ · dispatch_set_target_queueï¼šå¯ä»¥è®¾ç½®ä¼˜å…ˆçº§ï¼Œä¹Ÿå¯ä»¥è®¾ç½®é˜Ÿåˆ—å±‚çº§ä½“ç³»ï¼Œæ¯”å¦‚è®©å¤šä¸ªä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—åœ¨ç»Ÿä¸€ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—é‡Œä¸²è¡Œæ‰§è¡Œï¼Œå¦‚ä¸‹ 12345678910111213141516171819dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL);dispatch_queue_t firstQueue = dispatch_queue_create(&quot;com.starming.gcddemo.firstqueue&quot;, DISPATCH_QUEUE_SERIAL);dispatch_queue_t secondQueue = dispatch_queue_create(&quot;com.starming.gcddemo.secondqueue&quot;, DISPATCH_QUEUE_CONCURRENT);dispatch_set_target_queue(firstQueue, serialQueue);dispatch_set_target_queue(secondQueue, serialQueue);dispatch_async(firstQueue, ^&#123; NSLog(@&quot;1&quot;); [NSThread sleepForTimeInterval:3.f];&#125;);dispatch_async(secondQueue, ^&#123; NSLog(@&quot;2&quot;); [NSThread sleepForTimeInterval:2.f];&#125;);dispatch_async(secondQueue, ^&#123; NSLog(@&quot;3&quot;); [NSThread sleepForTimeInterval:1.f];&#125;); é˜Ÿåˆ—ç±»å‹é˜Ÿåˆ—é»˜è®¤æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœè®¾ç½®æ”¹å‚æ•°ä¸ºNULLä¼šæŒ‰ä¸²è¡Œå¤„ç†ï¼Œåªèƒ½æ‰§è¡Œä¸€ä¸ªå•ç‹¬çš„blockï¼Œé˜Ÿåˆ—ä¹Ÿå¯ä»¥æ˜¯å¹¶è¡Œçš„ï¼ŒåŒä¸€æ—¶é—´æ‰§è¡Œå¤šä¸ªblock 123456789101112- (id)init;&#123; self = [super init]; if (self != nil) &#123; NSString *label = [NSString stringWithFormat:@&quot;%@.isolation.%p&quot;, [self class], self]; self.isolationQueue = dispatch_queue_create([label UTF8String], 0); label = [NSString stringWithFormat:@&quot;%@.work.%p&quot;, [self class], self]; self.workQueue = dispatch_queue_create([label UTF8String], 0); &#125; return self;&#125; 5ç§é˜Ÿåˆ—ï¼Œä¸»é˜Ÿåˆ—ï¼ˆmain queueï¼‰,å››ç§é€šç”¨è°ƒåº¦é˜Ÿåˆ—ï¼Œè‡ªå·±å®šåˆ¶çš„é˜Ÿåˆ—ã€‚å››ç§é€šç”¨è°ƒåº¦é˜Ÿåˆ—ä¸º QOS_CLASS_USER_INTERACTIVEï¼šuser interactiveç­‰çº§è¡¨ç¤ºä»»åŠ¡éœ€è¦è¢«ç«‹å³æ‰§è¡Œæä¾›å¥½çš„ä½“éªŒï¼Œç”¨æ¥æ›´æ–°UIï¼Œå“åº”äº‹ä»¶ç­‰ã€‚è¿™ä¸ªç­‰çº§æœ€å¥½ä¿æŒå°è§„æ¨¡ã€‚ QOS_CLASS_USER_INITIATEDï¼šuser initiatedç­‰çº§è¡¨ç¤ºä»»åŠ¡ç”±UIå‘èµ·å¼‚æ­¥æ‰§è¡Œã€‚é€‚ç”¨åœºæ™¯æ˜¯éœ€è¦åŠæ—¶ç»“æœåŒæ—¶åˆå¯ä»¥ç»§ç»­äº¤äº’çš„æ—¶å€™ã€‚ QOS_CLASS_UTILITYï¼šutilityç­‰çº§è¡¨ç¤ºéœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œä¼´æœ‰ç”¨æˆ·å¯è§è¿›åº¦æŒ‡ç¤ºå™¨ã€‚ç»å¸¸ä¼šç”¨æ¥åšè®¡ç®—ï¼ŒI/Oï¼Œç½‘ç»œï¼ŒæŒç»­çš„æ•°æ®å¡«å……ç­‰ä»»åŠ¡ã€‚è¿™ä¸ªä»»åŠ¡èŠ‚èƒ½ã€‚ QOS_CLASS_BACKGROUNDï¼šbackgroundç­‰çº§è¡¨ç¤ºç”¨æˆ·ä¸ä¼šå¯Ÿè§‰çš„ä»»åŠ¡ï¼Œä½¿ç”¨å®ƒæ¥å¤„ç†é¢„åŠ è½½ï¼Œæˆ–è€…ä¸éœ€è¦ç”¨æˆ·äº¤äº’å’Œå¯¹æ—¶é—´ä¸æ•æ„Ÿçš„ä»»åŠ¡ã€‚ç¤ºä¾‹ï¼šåå°åŠ è½½æ˜¾ç¤ºå›¾ç‰‡12345678910override func viewDidLoad() &#123; super.viewDidLoad() dispatch_async(dispatch_get_global_queue(Int(QOS_CLASS_USER_INITIATED.value), 0)) &#123; // å°†å·¥ä½œä»ä¸»çº¿ç¨‹è½¬ç§»åˆ°å…¨å±€é˜Ÿåˆ—ä¸­ï¼Œè¿™æ˜¯dispatch_asyncè°ƒç”¨ï¼Œå¼‚æ­¥æäº¤ä¿è¯è°ƒç”¨çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œè¿™æ ·viewDidLoadåœ¨ä¸»çº¿ç¨‹ä¸Šèƒ½å¤Ÿæ›´æ—©å®Œæˆï¼Œ let overlayImage = self.faceOverlayImageFromImage(self.image) dispatch_async(dispatch_get_main_queue()) &#123; // æ–°å›¾å®Œæˆï¼ŒæŠŠä¸€ä¸ªé—­åŒ…åŠ å…¥ä¸»çº¿ç¨‹ç”¨æ¥æ›´æ–°UIImageViewï¼Œåªæœ‰åœ¨ä¸»çº¿ç¨‹èƒ½æ“ä½œUIKitã€‚ self.fadeInNewImage(overlayImage) // æ›´æ–°UI &#125; &#125;&#125; ä½•æ—¶ä½¿ç”¨ä½•ç§é˜Ÿåˆ—ç±»å‹ ä¸»é˜Ÿåˆ—ï¼ˆé¡ºåºï¼‰ï¼šé˜Ÿåˆ—ä¸­æœ‰ä»»åŠ¡å®Œæˆéœ€è¦æ›´æ–°UIæ—¶ï¼Œdispatch_afteråœ¨è¿™ç§ç±»å‹ä¸­ä½¿ç”¨ã€‚ å¹¶å‘é˜Ÿåˆ—ï¼šç”¨æ¥æ‰§è¡Œä¸UIæ— å…³çš„åå°ä»»åŠ¡ï¼Œdispatch_syncæ”¾åœ¨è¿™é‡Œï¼Œæ–¹ä¾¿ç­‰å¾…ä»»åŠ¡å®Œæˆè¿›è¡Œåç»­å¤„ç†æˆ–å’Œdispatch barrieråŒæ­¥ã€‚dispatch groupsæ”¾åœ¨è¿™é‡Œä¹Ÿä¸é”™ã€‚ è‡ªå®šä¹‰é¡ºåºé˜Ÿåˆ—ï¼šé¡ºåºæ‰§è¡Œåå°ä»»åŠ¡å¹¶è¿½è¸ªå®ƒæ—¶ã€‚è¿™æ ·åšåŒæ—¶åªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œå¯ä»¥é˜²æ­¢èµ„æºç«äº‰ã€‚dipatch barriersè§£å†³è¯»å†™é”é—®é¢˜çš„æ”¾åœ¨è¿™é‡Œå¤„ç†ã€‚dispatch groupsä¹Ÿæ˜¯æ”¾åœ¨è¿™é‡Œã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ç®€åŒ–QoSç­‰çº§å‚æ•°çš„å†™æ³• 1234567891011121314151617181920212223var GlobalMainQueue: dispatch_queue_t &#123; return dispatch_get_main_queue()&#125;var GlobalUserInteractiveQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_USER_INTERACTIVE.value), 0)&#125;var GlobalUserInitiatedQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_USER_INITIATED.value), 0)&#125;var GlobalUtilityQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_UTILITY.value), 0)&#125;var GlobalBackgroundQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_BACKGROUND.value), 0)&#125;//ä½¿ç”¨èµ·æ¥å°±æ˜¯è¿™æ ·ï¼Œæ˜“è¯»è€Œä¸”å®¹æ˜“çœ‹å‡ºåœ¨ä½¿ç”¨å“ªä¸ªé˜Ÿåˆ—dispatch_async(GlobalUserInitiatedQueue) &#123; let overlayImage = self.faceOverlayImageFromImage(self.image) dispatch_async(GlobalMainQueue) &#123; self.fadeInNewImage(overlayImage) &#125;&#125; dispatch_onceç”¨æ³•dispatch_once_tè¦æ˜¯å…¨å±€æˆ–staticå˜é‡ï¼Œä¿è¯dispatch_once_tåªæœ‰ä¸€ä»½å®ä¾‹1234567891011+ (UIColor *)boringColor;&#123; static UIColor *color; //åªè¿è¡Œä¸€æ¬¡ static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; color = [UIColor colorWithRed:0.380f green:0.376f blue:0.376f alpha:1.000f]; &#125;); return color;&#125;dispatch_async è®¾è®¡ä¸€ä¸ªå¼‚æ­¥çš„APIè°ƒç”¨dispatch_async()ï¼Œè¿™ä¸ªè°ƒç”¨æ”¾åœ¨APIçš„æ–¹æ³•æˆ–å‡½æ•°ä¸­åšã€‚è®©APIçš„ä½¿ç”¨è€…è®¾ç½®ä¸€ä¸ªå›è°ƒå¤„ç†é˜Ÿåˆ— 123456789- (void)processImage:(UIImage *)image completionHandler:(void(^)(BOOL success))handler;&#123; dispatch_async(self.isolationQueue, ^(void)&#123; // do actual processing here dispatch_async(self.resultQueue, ^(void)&#123; handler(YES); &#125;); &#125;);&#125; å¯ä»¥é¿å…ç•Œé¢ä¼šè¢«ä¸€äº›è€—æ—¶çš„æ“ä½œå¡æ­»ï¼Œæ¯”å¦‚è¯»å–ç½‘ç»œæ•°æ®ï¼Œå¤§æ•°æ®IOï¼Œè¿˜æœ‰å¤§é‡æ•°æ®çš„æ•°æ®åº“è¯»å†™ï¼Œè¿™æ—¶éœ€è¦åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†ï¼Œç„¶åé€šçŸ¥ä¸»çº¿ç¨‹æ›´æ–°ç•Œé¢ï¼ŒGCDä½¿ç”¨èµ·æ¥æ¯”NSThreadå’ŒNSOperationæ–¹æ³•è¦ç®€å•æ–¹ä¾¿ã€‚12345678910111213141516171819//ä»£ç æ¡†æ¶dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; // è€—æ—¶çš„æ“ä½œ dispatch_async(dispatch_get_main_queue(), ^&#123; // æ›´æ–°ç•Œé¢ &#125;);&#125;);//ä¸‹è½½å›¾ç‰‡çš„ç¤ºä¾‹dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSURL * url = [NSURL URLWithString:@&quot;http://avatar.csdn.net/2/C/D/1_totogo2010.jpg&quot;]; NSData * data = [[NSData alloc]initWithContentsOfURL:url]; UIImage *image = [[UIImage alloc]initWithData:data]; if (data != nil) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; self.imageView.image = image; &#125;); &#125;&#125;); dispatch_afterå»¶åæ‰§è¡Œdispatch_afteråªæ˜¯å»¶æ—¶æäº¤blockï¼Œä¸æ˜¯å»¶æ—¶ç«‹åˆ»æ‰§è¡Œã€‚12345678- (void)foo&#123; double delayInSeconds = 2.0; dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t) (delayInSeconds * NSEC_PER_SEC)); dispatch_after(popTime, dispatch_get_main_queue(), ^(void)&#123; [self bar]; &#125;);&#125; èŒƒä¾‹ï¼Œå®ç°ä¸€ä¸ªæ¨è¿Ÿå‡ºç°å¼¹å‡ºæ¡†æç¤ºï¼Œæ¯”å¦‚è¯´æç¤ºç”¨æˆ·è¯„ä»·ç­‰åŠŸèƒ½ã€‚12345678910111213func showOrHideNavPrompt() &#123; let delayInSeconds = 1.0 let popTime = dispatch_time(DISPATCH_TIME_NOW, Int64(delayInSeconds * Double(NSEC_PER_SEC))) // åœ¨è¿™é‡Œå£°æ˜æ¨è¿Ÿçš„æ—¶é—´ dispatch_after(popTime, GlobalMainQueue) &#123; // ç­‰å¾…delayInSecondså°†é—­åŒ…å¼‚æ­¥åˆ°ä¸»é˜Ÿåˆ— let count = PhotoManager.sharedManager.photos.count if count &gt; 0 &#123; self.navigationItem.prompt = nil &#125; else &#123; self.navigationItem.prompt = &quot;Add photos with faces to Googlyify them!&quot; &#125; &#125;&#125; ä¾‹å­ä¸­çš„dispatch timeçš„å‚æ•°ï¼Œå¯ä»¥å…ˆçœ‹çœ‹å‡½æ•°åŸå‹ 1dispatch_time_t dispatch_time ( dispatch_time_t when, int64_t delta ); ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºDISPATCH_TIME_NOWè¡¨ç¤ºå½“å‰ã€‚ç¬¬äºŒä¸ªå‚æ•°çš„deltaè¡¨ç¤ºçº³ç§’ï¼Œä¸€ç§’å¯¹åº”çš„çº³ç§’ä¸º1000000000ï¼Œç³»ç»Ÿæä¾›äº†ä¸€äº›å®æ¥ç®€åŒ– 123#define NSEC_PER_SEC 1000000000ull //æ¯ç§’æœ‰å¤šå°‘çº³ç§’#define USEC_PER_SEC 1000000ull //æ¯ç§’æœ‰å¤šå°‘æ¯«ç§’#define NSEC_PER_USEC 1000ull //æ¯æ¯«ç§’æœ‰å¤šå°‘çº³ç§’ è¿™æ ·å¦‚æœè¦è¡¨ç¤ºä¸€ç§’å°±å¯ä»¥è¿™æ ·å†™123dispatch_time(DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC);dispatch_time(DISPATCH_TIME_NOW, 1000 * USEC_PER_SEC);dispatch_time(DISPATCH_TIME_NOW, USEC_PER_SEC * NSEC_PER_USEC); dispatch_barrier_asyncä½¿ç”¨Barrier Taskæ–¹æ³•Dispatch Barrierè§£å†³å¤šçº¿ç¨‹å¹¶å‘è¯»å†™åŒä¸€ä¸ªèµ„æºå‘ç”Ÿæ­»é”Dispatch Barrierç¡®ä¿æäº¤çš„é—­åŒ…æ˜¯æŒ‡å®šé˜Ÿåˆ—ä¸­åœ¨ç‰¹å®šæ—¶æ®µå”¯ä¸€åœ¨æ‰§è¡Œçš„ä¸€ä¸ªã€‚åœ¨æ‰€æœ‰å…ˆäºDispatch Barrierçš„ä»»åŠ¡éƒ½å®Œæˆçš„æƒ…å†µä¸‹è¿™ä¸ªé—­åŒ…æ‰å¼€å§‹æ‰§è¡Œã€‚è½®åˆ°è¿™ä¸ªé—­åŒ…æ—¶barrierä¼šæ‰§è¡Œè¿™ä¸ªé—­åŒ…å¹¶ä¸”ç¡®ä¿é˜Ÿåˆ—åœ¨æ­¤è¿‡ç¨‹ä¸ä¼šæ‰§è¡Œå…¶å®ƒä»»åŠ¡ã€‚é—­åŒ…å®Œæˆåé˜Ÿåˆ—æ¢å¤ã€‚éœ€è¦æ³¨æ„dispatch_barrier_asyncåªåœ¨è‡ªå·±åˆ›å»ºçš„é˜Ÿåˆ—ä¸Šæœ‰è¿™ç§ä½œç”¨ï¼Œåœ¨å…¨å±€å¹¶å‘é˜Ÿåˆ—å’Œä¸²è¡Œé˜Ÿåˆ—ä¸Šï¼Œæ•ˆæœå’Œdispatch_syncä¸€æ · 1234567891011121314151617181920212223242526272829303132333435363738//åˆ›å»ºé˜Ÿåˆ—self.isolationQueue = dispatch_queue_create([label UTF8String], DISPATCH_QUEUE_CONCURRENT);//æ”¹å˜setter- (void)setCount:(NSUInteger)count forKey:(NSString *)key&#123; key = [key copy]; //ç¡®ä¿æ‰€æœ‰barrieréƒ½æ˜¯asyncå¼‚æ­¥çš„ dispatch_barrier_async(self.isolationQueue, ^()&#123; if (count == 0) &#123; [self.counts removeObjectForKey:key]; &#125; else &#123; self.counts[key] = @(count); &#125; &#125;);&#125;- (void)dispatchBarrierAsyncDemo &#123; //é˜²æ­¢æ–‡ä»¶è¯»å†™å†²çªï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œæ“ä½œéƒ½åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œï¼Œæ²¡æœ‰æ›´æ–°æ•°æ®è¯»ç”¨å¹¶è¡Œï¼Œå†™ç”¨ä¸²è¡Œã€‚ dispatch_queue_t dataQueue = dispatch_queue_create(&quot;com.starming.gcddemo.dataqueue&quot;, DISPATCH_QUEUE_CONCURRENT); dispatch_async(dataQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;read data 1&quot;); &#125;); dispatch_async(dataQueue, ^&#123; NSLog(@&quot;read data 2&quot;); &#125;); //ç­‰å¾…å‰é¢çš„éƒ½å®Œæˆï¼Œåœ¨æ‰§è¡Œbarrieråé¢çš„ dispatch_barrier_async(dataQueue, ^&#123; NSLog(@&quot;write data 1&quot;); [NSThread sleepForTimeInterval:1]; &#125;); dispatch_async(dataQueue, ^&#123; [NSThread sleepForTimeInterval:1.f]; NSLog(@&quot;read data 3&quot;); &#125;); dispatch_async(dataQueue, ^&#123; NSLog(@&quot;read data 4&quot;); &#125;);&#125; swiftç¤ºä¾‹12345678910111213141516171819202122//ä½¿ç”¨dispatch_queue_createåˆå§‹åŒ–ä¸€ä¸ªå¹¶å‘é˜Ÿåˆ—ã€‚ç¬¬ä¸€ä¸ªå‚æ•°éµå¾ªåå‘DNSå‘½åä¹ æƒ¯ï¼Œæ–¹ä¾¿æè¿°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å‡ºæ˜¯å¹¶å‘è¿˜æ˜¯é¡ºåºã€‚private let concurrentPhotoQueue = dispatch_queue_create(&quot;com.raywenderlich.GooglyPuff.photoQueue&quot;, DISPATCH_QUEUE_CONCURRENT)func addPhoto(photo: Photo) &#123; dispatch_barrier_async(concurrentPhotoQueue) &#123; // å°†å†™æ“ä½œåŠ å…¥åˆ°è‡ªå®šä¹‰çš„é˜Ÿåˆ—ã€‚å¼€å§‹æ‰§è¡Œæ—¶è¿™ä¸ªå°±æ˜¯é˜Ÿåˆ—ä¸­å”¯ä¸€çš„ä¸€ä¸ªåœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚ self._photos.append(photo) // barrierèƒ½å¤Ÿä¿éšœä¸ä¼šå’Œå…¶ä»–ä»»åŠ¡åŒæ—¶è¿›è¡Œã€‚ dispatch_async(GlobalMainQueue) &#123; // æ¶‰åŠåˆ°UIæ‰€ä»¥è¿™ä¸ªé€šçŸ¥åº”è¯¥åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥åˆ†æ´¾å¦ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡åˆ°ä¸»é˜Ÿåˆ—ä¸­ã€‚ self.postContentAddedNotification() &#125; &#125;&#125;//ä¸Šé¢æ˜¯è§£å†³äº†å†™å¯èƒ½å‘ç”Ÿæ­»é”ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨dispatch_syncè§£å†³è¯»æ—¶å¯èƒ½ä¼šå‘ç”Ÿçš„æ­»é”ã€‚var photos: [Photo] &#123; var photosCopy: [Photo]! dispatch_sync(concurrentPhotoQueue) &#123; // åŒæ­¥è°ƒåº¦åˆ°concurrentPhotoQueueé˜Ÿåˆ—æ‰§è¡Œè¯»æ“ä½œ photosCopy = self._photos // ä¿å­˜ &#125; return photosCopy&#125;//è¿™æ ·è¯»å†™é—®é¢˜éƒ½è§£å†³äº†ã€‚ éƒ½ç”¨å¼‚æ­¥å¤„ç†é¿å…æ­»é”ï¼Œå¼‚æ­¥çš„ç¼ºç‚¹åœ¨äºè°ƒè¯•ä¸æ–¹ä¾¿ï¼Œä½†æ˜¯æ¯”èµ·åŒæ­¥å®¹æ˜“äº§ç”Ÿæ­»é”è¿™ä¸ªå‰¯ä½œç”¨è¿˜ç®—å°çš„ã€‚ dispatch_applyè¿›è¡Œå¿«é€Ÿè¿­ä»£ç±»ä¼¼forå¾ªç¯ï¼Œä½†æ˜¯åœ¨å¹¶å‘é˜Ÿåˆ—çš„æƒ…å†µä¸‹dispatch_applyä¼šå¹¶å‘æ‰§è¡Œblockä»»åŠ¡ã€‚12345678910111213for (size_t y = 0; y &lt; height; ++y) &#123; for (size_t x = 0; x &lt; width; ++x) &#123; // Do something with x and y here &#125;&#125;//å› ä¸ºå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨dispatch_applyå¯ä»¥è¿è¡Œçš„æ›´å¿«- (void)dispatchApplyDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT); dispatch_apply(10, concurrentQueue, ^(size_t i) &#123; NSLog(@&quot;%zu&quot;,i); &#125;); NSLog(@&quot;The end&quot;); //è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œdispatch_applyè¿™ä¸ªæ˜¯ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„ã€‚è¿™ä¸ªlogæ‰“å°ä¼šåœ¨dispatch_applyéƒ½ç»“æŸåæ‰å¼€å§‹æ‰§è¡Œ&#125; dispatch_applyèƒ½é¿å…çº¿ç¨‹çˆ†ç‚¸ï¼Œå› ä¸ºGCDä¼šç®¡ç†å¹¶å‘123456789101112131415161718- (void)dealWiththreadWithMaybeExplode:(BOOL)explode &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); if (explode) &#123; //æœ‰é—®é¢˜çš„æƒ…å†µï¼Œå¯èƒ½ä¼šæ­»é” for (int i = 0; i &lt; 999 ; i++) &#123; dispatch_async(concurrentQueue, ^&#123; NSLog(@&quot;wrong %d&quot;,i); //do something hard &#125;); &#125; &#125; else &#123; //ä¼šä¼˜åŒ–å¾ˆå¤šï¼Œèƒ½å¤Ÿåˆ©ç”¨GCDç®¡ç† dispatch_apply(999, concurrentQueue, ^(size_t i)&#123; NSLog(@&quot;correct %zu&quot;,i); //do something hard &#125;); &#125;&#125; ç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526272829func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; var storedError: NSError! var downloadGroup = dispatch_group_create() let addresses = [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] dispatch_apply(UInt(addresses.count), GlobalUserInitiatedQueue) &#123; i in let index = Int(i) let address = addresses[index] let url = NSURL(string: address) dispatch_group_enter(downloadGroup) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; Blockç»„åˆDispatch_groupsdispatch groupsæ˜¯ä¸“é—¨ç”¨æ¥ç›‘è§†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚dispatch_group_tå®ä¾‹ç”¨æ¥è¿½è¸ªä¸åŒé˜Ÿåˆ—ä¸­çš„ä¸åŒä»»åŠ¡ã€‚ å½“groupé‡Œæ‰€æœ‰äº‹ä»¶éƒ½å®ŒæˆGCD APIæœ‰ä¸¤ç§æ–¹å¼å‘é€é€šçŸ¥ï¼Œç¬¬ä¸€ç§æ˜¯dispatch_group_waitï¼Œä¼šé˜»å¡å½“å‰è¿›ç¨‹ï¼Œç­‰æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆæˆ–ç­‰å¾…è¶…æ—¶ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨dispatch_group_notifyï¼Œå¼‚æ­¥æ‰§è¡Œé—­åŒ…ï¼Œä¸ä¼šé˜»å¡ã€‚ ç¬¬ä¸€ç§ä½¿ç”¨dispatch_group_waitçš„swiftçš„ä¾‹å­ï¼š1234567891011121314151617181920212223242526272829func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; dispatch_async(GlobalUserInitiatedQueue) &#123; // å› ä¸ºdispatch_group_waitä¼šç§Ÿå¡å½“å‰è¿›ç¨‹ï¼Œæ‰€ä»¥è¦ä½¿ç”¨dispatch_asyncå°†æ•´ä¸ªæ–¹æ³•è¦æ”¾åˆ°åå°é˜Ÿåˆ—æ‰èƒ½å¤Ÿä¿è¯ä¸»çº¿ç¨‹ä¸è¢«é˜»å¡ var storedError: NSError! var downloadGroup = dispatch_group_create() // åˆ›å»ºä¸€ä¸ªdispatch group for address in [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] &#123; let url = NSURL(string: address) dispatch_group_enter(downloadGroup) // dispatch_group_enteræ˜¯é€šçŸ¥dispatch groupä»»åŠ¡å¼€å§‹äº†ï¼Œdispatch_group_enterå’Œdispatch_group_leaveæ˜¯æˆå¯¹è°ƒç”¨ï¼Œä¸ç„¶ç¨‹åºå°±å´©æºƒäº†ã€‚ let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) // ä¿æŒå’Œdispatch_group_enteré…å¯¹ã€‚é€šçŸ¥ä»»åŠ¡å·²ç»å®Œæˆ &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_wait(downloadGroup, DISPATCH_TIME_FOREVER) // dispatch_group_waitç­‰å¾…æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆç›´åˆ°è¶…æ—¶ã€‚å¦‚æœä»»åŠ¡å®Œæˆå‰å°±è¶…æ—¶äº†ï¼Œå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéé›¶å€¼ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼åˆ¤æ–­æ˜¯å¦è¶…æ—¶ã€‚ä¹Ÿå¯ä»¥ç”¨DISPATCH_TIME_FOREVERè¡¨ç¤ºä¸€ç›´ç­‰ã€‚ dispatch_async(GlobalMainQueue) &#123; // è¿™é‡Œå¯ä»¥ä¿è¯æ‰€æœ‰å›¾ç‰‡ä»»åŠ¡éƒ½å®Œæˆï¼Œç„¶ååœ¨main queueé‡ŒåŠ å…¥å®Œæˆåè¦å¤„ç†çš„é—­åŒ…ï¼Œä¼šåœ¨main queueé‡Œæ‰§è¡Œã€‚ if let completion = completion &#123; // æ‰§è¡Œé—­åŒ…å†…å®¹ completion(error: storedError) &#125; &#125; &#125;&#125; ocä¾‹å­1234567891011121314- (void)dispatchGroupWaitDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); //åœ¨groupä¸­æ·»åŠ é˜Ÿåˆ—çš„block dispatch_group_async(group, concurrentQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_wait(group, DISPATCH_TIME_FOREVER); NSLog(@&quot;go on&quot;);&#125; ç¬¬äºŒç§ä½¿ç”¨dispatch_group_notifyçš„swiftçš„ä¾‹å­ï¼š123456789101112131415161718192021222324252627func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; // ä¸ç”¨åŠ dispatch_asyncï¼Œå› ä¸ºæ²¡æœ‰é˜»å¡ä¸»è¿›ç¨‹ var storedError: NSError! var downloadGroup = dispatch_group_create() for address in [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] &#123; let url = NSURL(string: address) dispatch_group_enter(downloadGroup) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; // dispatch_group_notifyå’Œdispatch_group_waitçš„åŒºåˆ«å°±æ˜¯æ˜¯å¼‚æ­¥æ‰§è¡Œé—­åŒ…çš„ï¼Œå½“dispatch groupsä¸­æ²¡æœ‰å‰©ä½™çš„ä»»åŠ¡æ—¶é—­åŒ…æ‰æ‰§è¡Œã€‚è¿™é‡Œæ˜¯æŒ‡æ˜åœ¨ä¸»é˜Ÿåˆ—ä¸­æ‰§è¡Œã€‚ if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; ocä¾‹å­1234567891011121314151617181920212223242526272829303132//dispatch_group_notify- (void)dispatchGroupNotifyDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123; NSLog(@&quot;end&quot;); &#125;); NSLog(@&quot;can continue&quot;);&#125;//dispatch_group_wait- (void)dispatchGroupWaitDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); //åœ¨groupä¸­æ·»åŠ é˜Ÿåˆ—çš„block dispatch_group_async(group, concurrentQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_wait(group, DISPATCH_TIME_FOREVER); NSLog(@&quot;can continue&quot;);&#125; å¦‚ä½•å¯¹ç°æœ‰APIä½¿ç”¨dispatch_group_t12345678910111213141516171819202122232425262728293031323334//ç»™Core Dataçš„-performBlock:æ·»åŠ groupsã€‚ç»„åˆå®Œæˆä»»åŠ¡åä½¿ç”¨dispatch_group_notifyæ¥è¿è¡Œä¸€ä¸ªblockå³å¯ã€‚- (void)withGroup:(dispatch_group_t)group performBlock:(dispatch_block_t)block&#123; if (group == NULL) &#123; [self performBlock:block]; &#125; else &#123; dispatch_group_enter(group); [self performBlock:^()&#123; block(); dispatch_group_leave(group); &#125;]; &#125;&#125;//NSURLConnectionä¹Ÿå¯ä»¥è¿™æ ·åš+ (void)withGroup:(dispatch_group_t)group sendAsynchronousRequest:(NSURLRequest *)request queue:(NSOperationQueue *)queue completionHandler:(void (^)(NSURLResponse*, NSData*, NSError*))handler&#123; if (group == NULL) &#123; [self sendAsynchronousRequest:request queue:queue completionHandler:handler]; &#125; else &#123; dispatch_group_enter(group); [self sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)&#123; handler(response, data, error); dispatch_group_leave(group); &#125;]; &#125;&#125; æ³¨æ„äº‹é¡¹ dispatch_group_asyncç­‰ä»·äºdispatch_group_enter() å’Œ dispatch_group_leave()çš„ç»„åˆã€‚ dispatch_group_enter() å¿…é¡»è¿è¡Œåœ¨ dispatch_group_leave() ä¹‹å‰ã€‚ dispatch_group_enter() å’Œ dispatch_group_leave() éœ€è¦æˆå¯¹å‡ºç°çš„ Dispatch Blocké˜Ÿåˆ—æ‰§è¡Œä»»åŠ¡éƒ½æ˜¯blockçš„æ–¹å¼ï¼Œ åˆ›å»ºblock 1234567891011121314- (void)createDispatchBlock &#123; //normal way dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_block_t block = dispatch_block_create(0, ^&#123; NSLog(@&quot;run block&quot;); &#125;); dispatch_async(concurrentQueue, block); //QOS way dispatch_block_t qosBlock = dispatch_block_create_with_qos_class(0, QOS_CLASS_USER_INITIATED, -1, ^&#123; NSLog(@&quot;run qos block&quot;); &#125;); dispatch_async(concurrentQueue, qosBlock);&#125; dispatch_block_waitï¼šå¯ä»¥æ ¹æ®dispatch blockæ¥è®¾ç½®ç­‰å¾…æ—¶é—´ï¼Œå‚æ•°DISPATCH_TIME_FOREVERä¼šä¸€ç›´ç­‰å¾…blockç»“æŸ 123456789101112- (void)dispatchBlockWaitDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t block = dispatch_block_create(0, ^&#123; NSLog(@&quot;star&quot;); [NSThread sleepForTimeInterval:5.f]; NSLog(@&quot;end&quot;); &#125;); dispatch_async(serialQueue, block); //è®¾ç½®DISPATCH_TIME_FOREVERä¼šä¸€ç›´ç­‰åˆ°å‰é¢ä»»åŠ¡éƒ½å®Œæˆ dispatch_block_wait(block, DISPATCH_TIME_FOREVER); NSLog(@&quot;ok, now can go on&quot;);&#125; dispatch_block_notifyï¼šå¯ä»¥ç›‘è§†æŒ‡å®šdispatch blockç»“æŸï¼Œç„¶åå†åŠ å…¥ä¸€ä¸ªblockåˆ°é˜Ÿåˆ—ä¸­ã€‚ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼Œç¬¬ä¸€ä¸ªæ˜¯éœ€è¦ç›‘è§†çš„blockï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦æäº¤æ‰§è¡Œçš„é˜Ÿåˆ—ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¾…åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­çš„block 1234567891011121314- (void)dispatchBlockNotifyDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t firstBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;first block start&quot;); [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;first block end&quot;); &#125;); dispatch_async(serialQueue, firstBlock); dispatch_block_t secondBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;second block run&quot;); &#125;); //first blockæ‰§è¡Œå®Œæ‰åœ¨serial queueä¸­æ‰§è¡Œsecond block dispatch_block_notify(firstBlock, serialQueue, secondBlock);&#125; dispatch_block_cancelï¼šiOS8åGCDæ”¯æŒå¯¹dispatch blockçš„å–æ¶ˆ123456789101112131415- (void)dispatchBlockCancelDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t firstBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;first block start&quot;); [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;first block end&quot;); &#125;); dispatch_block_t secondBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;second block run&quot;); &#125;); dispatch_async(serialQueue, firstBlock); dispatch_async(serialQueue, secondBlock); //å–æ¶ˆsecondBlock dispatch_block_cancel(secondBlock);&#125; ä½¿ç”¨dispatch block objectï¼ˆè°ƒåº¦å—ï¼‰åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿›è¡Œå–æ¶ˆdispatch block objectå¯ä»¥ä¸ºé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è®¾ç½® ç¤ºä¾‹ï¼Œä¸‹è½½å›¾ç‰‡ä¸­é€”è¿›è¡Œå–æ¶ˆ123456789101112131415161718192021222324252627282930313233343536373839404142func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; var storedError: NSError! let downloadGroup = dispatch_group_create() var addresses = [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] addresses += addresses + addresses // æ‰©å±•addressæ•°ç»„ï¼Œå¤åˆ¶3ä»½ var blocks: [dispatch_block_t] = [] // ä¸€ä¸ªä¿å­˜blockçš„æ•°ç»„ for i in 0 ..&lt; addresses.count &#123; dispatch_group_enter(downloadGroup) let block = dispatch_block_create(DISPATCH_BLOCK_INHERIT_QOS_CLASS) &#123; // åˆ›å»ºä¸€ä¸ªblockï¼Œblockçš„æ ‡å¿—æ˜¯DISPATCH_BLOCK_INHERIT_QOS_CLASS let index = Int(i) let address = addresses[index] let url = NSURL(string: address) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; blocks.append(block) dispatch_async(GlobalMainQueue, block) // æŠŠè¿™ä¸ªblockæ”¾åˆ°GlobalMainQueueä¸Šå¼‚æ­¥è°ƒç”¨ã€‚å› ä¸ºå…¨å±€é˜Ÿåˆ—æ˜¯ä¸€ä¸ªé¡ºåºé˜Ÿåˆ—æ‰€ä»¥æ–¹ä¾¿å–æ¶ˆå¯¹è±¡blockï¼ŒåŒæ—¶å¯ä»¥ä¿è¯ä¸‹è½½ä»»åŠ¡åœ¨downloadPhotosWithCompletionè¿”å›åæ‰å¼€å§‹æ‰§è¡Œã€‚ &#125; for block in blocks[3 ..&lt; blocks.count] &#123; let cancel = arc4random_uniform(2) // éšæœºè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä¼šè¿”å›0æˆ–1 if cancel == 1 &#123; dispatch_block_cancel(block) // å¦‚æœæ˜¯1å°±å–æ¶ˆblockï¼Œè¿™ä¸ªåªèƒ½å‘ç”Ÿåœ¨blockè¿˜åœ¨é˜Ÿåˆ—ä¸­å¹¶æ²¡æœ‰å¼€å§‹çš„æƒ…å†µä¸‹ã€‚å› ä¸ºæŠŠblockå·²ç»æ”¾åˆ°äº†GlobalMainQueueä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹ä¼šå…ˆæ‰§è¡Œï¼Œæ‰§è¡Œå®Œäº†æ‰ä¼šæ‰§è¡Œblockã€‚ dispatch_group_leave(downloadGroup) // å› ä¸ºå·²ç»dispatch_group_enteräº†ï¼Œæ‰€ä»¥å–æ¶ˆæ—¶ä¹Ÿè¦å°†å…¶éƒ½leaveæ‰ã€‚ &#125; &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; Dispatch IO æ–‡ä»¶æ“ä½œdispatch ioè¯»å–æ–‡ä»¶çš„æ–¹å¼ç±»ä¼¼äºä¸‹é¢çš„æ–¹å¼ï¼Œå¤šä¸ªçº¿ç¨‹å»è¯»å–æ–‡ä»¶çš„åˆ‡ç‰‡æ•°æ®ï¼Œå¯¹äºå¤§çš„æ•°æ®æ–‡ä»¶è¿™æ ·ä¼šæ¯”å•çº¿ç¨‹è¦å¿«å¾ˆå¤šã€‚123dispatch_async(queue,^&#123;/*read 0-99 bytes*/&#125;);dispatch_async(queue,^&#123;/*read 100-199 bytes*/&#125;);dispatch_async(queue,^&#123;/*read 200-299 bytes*/&#125;); dispatch_io_createï¼šåˆ›å»ºdispatch io dispatch_io_set_low_waterï¼šæŒ‡å®šåˆ‡å‰²æ–‡ä»¶å¤§å° dispatch_io_readï¼šè¯»å–åˆ‡å‰²çš„æ–‡ä»¶ç„¶ååˆå¹¶ã€‚è‹¹æœç³»ç»Ÿæ—¥å¿—APIé‡Œç”¨åˆ°äº†è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼šhttps://github.com/Apple-FOSS-Mirror/Libc/blob/2ca2ae74647714acfc18674c3114b1a5d3325d7d/gen/asl.c 12345678910111213141516171819202122232425262728293031323334353637383940pipe_q = dispatch_queue_create(&quot;PipeQ&quot;, NULL);//åˆ›å»ºpipe_channel = dispatch_io_create(DISPATCH_IO_STREAM, fd, pipe_q, ^(int err)&#123; close(fd);&#125;);*out_fd = fdpair[1];//è®¾ç½®åˆ‡å‰²å¤§å°dispatch_io_set_low_water(pipe_channel, SIZE_MAX);dispatch_io_read(pipe_channel, 0, SIZE_MAX, pipe_q, ^(bool done, dispatch_data_t pipedata, int err)&#123; if (err == 0) &#123; size_t len = dispatch_data_get_size(pipedata); if (len &gt; 0) &#123; //å¯¹æ¯æ¬¡åˆ‡å—æ•°æ®çš„å¤„ç† const char *bytes = NULL; char *encoded; uint32_t eval; dispatch_data_t md = dispatch_data_create_map(pipedata, (const void **)&amp;bytes, &amp;len); encoded = asl_core_encode_buffer(bytes, len); asl_msg_set_key_val(aux, ASL_KEY_AUX_DATA, encoded); free(encoded); eval = _asl_evaluate_send(NULL, (aslmsg)aux, -1); _asl_send_message(NULL, eval, aux, NULL); asl_msg_release(aux); dispatch_release(md); &#125; &#125; if (done) &#123; //semaphore +1ä½¿å¾—ä¸éœ€è¦å†ç­‰å¾…ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚ dispatch_semaphore_signal(sem); dispatch_release(pipe_channel); dispatch_release(pipe_q); &#125;&#125;); Dispatch Source ç”¨GCDç›‘è§†è¿›ç¨‹Dispatch Sourceç”¨äºç›‘å¬ç³»ç»Ÿçš„åº•å±‚å¯¹è±¡ï¼Œæ¯”å¦‚æ–‡ä»¶æè¿°ç¬¦ï¼ŒMachç«¯å£ï¼Œä¿¡å·é‡ç­‰ã€‚ä¸»è¦å¤„ç†çš„äº‹ä»¶å¦‚ä¸‹è¡¨ æ–¹æ³• è¯´æ˜ DISPATCH_SOURCE_TYPE_DATA_ADD æ•°æ®å¢åŠ  DISPATCH_SOURCE_TYPE_DATA_OR æ•°æ®OR DISPATCH_SOURCE_TYPE_MACH_RECV Machç«¯å£æ¥æ”¶ DISPATCH_SOURCE_TYPE_MEMORYPRESSURE å†…å­˜æƒ…å†µ DISPATCH_SOURCE_TYPE_READ è¯»æ•°æ® DISPATCH_SOURCE_TYPE_SIGNAL ä¿¡å· DISPATCH_SOURCE_TYPE_TIMER å®šæ—¶å™¨ DISPATCH_SOURCE_TYPE_VNODE æ–‡ä»¶ç³»ç»Ÿå˜åŒ– DISPATCH_SOURCE_TYPE_WRITE æ–‡ä»¶å†™å…¥ æ–¹æ³• dispatch_source_createï¼šåˆ›å»ºdispatch sourceï¼Œåˆ›å»ºåä¼šå¤„äºæŒ‚èµ·çŠ¶æ€è¿›è¡Œäº‹ä»¶æ¥æ”¶ï¼Œéœ€è¦è®¾ç½®äº‹ä»¶å¤„ç†handlerè¿›è¡Œäº‹ä»¶å¤„ç†ã€‚ dispatch_source_set_event_handlerï¼šè®¾ç½®äº‹ä»¶å¤„ç†handler dispatch_source_set_cancel_handlerï¼šäº‹ä»¶å–æ¶ˆhandlerï¼Œå°±æ˜¯åœ¨dispatch sourceé‡Šæ”¾å‰åšäº›æ¸…ç†çš„äº‹ã€‚ dispatch_source_cancelï¼šå…³é—­dispatch sourceï¼Œè®¾ç½®çš„äº‹ä»¶å¤„ç†handlerä¸ä¼šè¢«æ‰§è¡Œï¼Œå·²ç»æ‰§è¡Œçš„äº‹ä»¶handlerä¸ä¼šå–æ¶ˆã€‚ 1234567891011NSRunningApplication *mail = [NSRunningApplication runningApplicationsWithBundleIdentifier:@&quot;com.apple.mail&quot;];if (mail == nil) &#123; return;&#125;pid_t const pid = mail.processIdentifier;self.source = dispatch_source_create(DISPATCH_SOURCE_TYPE_PROC, pid, DISPATCH_PROC_EXIT, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(self.source, ^()&#123; NSLog(@&quot;Mail quit.&quot;);&#125;);//åœ¨äº‹ä»¶æºä¼ åˆ°ä½ çš„äº‹ä»¶å¤„ç†å‰éœ€è¦è°ƒç”¨dispatch_resume()è¿™ä¸ªæ–¹æ³•dispatch_resume(self.source); ç›‘è§†æ–‡ä»¶å¤¹å†…æ–‡ä»¶å˜åŒ–12345678910111213141516171819202122232425NSURL *directoryURL; // assume this is set to a directoryint const fd = open([[directoryURL path] fileSystemRepresentation], O_EVTONLY);if (fd &lt; 0) &#123; char buffer[80]; strerror_r(errno, buffer, sizeof(buffer)); NSLog(@&quot;Unable to open \&quot;%@\&quot;: %s (%d)&quot;, [directoryURL path], buffer, errno); return;&#125;dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_VNODE, fd,DISPATCH_VNODE_WRITE | DISPATCH_VNODE_DELETE, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(source, ^()&#123; unsigned long const data = dispatch_source_get_data(source); if (data &amp; DISPATCH_VNODE_WRITE) &#123; NSLog(@&quot;The directory changed.&quot;); &#125; if (data &amp; DISPATCH_VNODE_DELETE) &#123; NSLog(@&quot;The directory has been deleted.&quot;); &#125;&#125;);dispatch_source_set_cancel_handler(source, ^()&#123; close(fd);&#125;);self.source = source;dispatch_resume(self.source);//è¿˜è¦æ³¨æ„éœ€è¦ç”¨DISPATCH_VNODE_DELETE å»æ£€æŸ¥ç›‘è§†çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦è¢«åˆ é™¤ï¼Œå¦‚æœåˆ é™¤äº†å°±åœæ­¢ç›‘å¬ NSTimeråœ¨ä¸»çº¿ç¨‹çš„runloopé‡Œä¼šåœ¨runloopåˆ‡æ¢å…¶å®ƒæ¨¡å¼æ—¶åœæ­¢ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨åœ¨å­çº¿ç¨‹å¼€å¯ä¸€ä¸ªæ¨¡å¼ä¸ºNSRunLoopCommonModesçš„runloopï¼Œå¦‚æœä¸æƒ³å¼€å¯ä¸€ä¸ªæ–°çš„runloopå¯ä»¥ç”¨ä¸è·Ÿrunloopå…³è”çš„dispatch source timerï¼Œå¦‚ä¸‹ã€‚12345678dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,0, 0, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(source, ^()&#123; NSLog(@&quot;Time flies.&quot;);&#125;);dispatch_time_t startdispatch_source_set_timer(source, DISPATCH_TIME_NOW, 5ull * NSEC_PER_SEC,100ull * NSEC_PER_MSEC);self.source = source;dispatch_resume(self.source); Dispatch Semaphoreå’Œçš„ä»‹ç»å¦å¤–ä¸€ç§ä¿è¯åŒæ­¥çš„æ–¹æ³•ã€‚ä½¿ç”¨dispatch_semaphore_signalåŠ 1dispatch_semaphore_waitå‡1ï¼Œä¸º0æ—¶ç­‰å¾…çš„è®¾ç½®æ–¹å¼æ¥è¾¾åˆ°çº¿ç¨‹åŒæ­¥çš„ç›®çš„å’ŒåŒæ­¥é”ä¸€æ ·èƒ½å¤Ÿè§£å†³èµ„æºæŠ¢å çš„é—®é¢˜ã€‚12345678910111213//dispatch semaphore- (void)dispatchSemaphoreDemo &#123; //åˆ›å»ºsemaphore dispatch_semaphore_t semaphore = dispatch_semaphore_create(0); dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSLog(@&quot;start&quot;); [NSThread sleepForTimeInterval:1.f]; NSLog(@&quot;semaphore +1&quot;); dispatch_semaphore_signal(semaphore); //+1 semaphore &#125;); dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER); NSLog(@&quot;continue&quot;);&#125; é”è¿™é‡Œç®€å•ä»‹ç»ä¸‹iOSä¸­å¸¸ç”¨çš„å„ç§é”å’Œä»–ä»¬çš„æ€§èƒ½ã€‚ NSRecursiveLockï¼šé€’å½’é”ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åå¤è·å–é”ä¸ä¼šé€ æˆæ­»é”ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šè®°å½•è·å–é”å’Œé‡Šæ”¾é”çš„æ¬¡æ•°æ¥è¾¾åˆ°ä½•æ—¶é‡Šæ”¾çš„ä½œç”¨ã€‚ NSDistributedLockï¼šåˆ†å¸ƒé”ï¼ŒåŸºäºæ–‡ä»¶æ–¹å¼çš„é”æœºåˆ¶ï¼Œå¯ä»¥è·¨è¿›ç¨‹è®¿é—®ã€‚ NSConditionLockï¼šæ¡ä»¶é”ï¼Œç”¨æˆ·å®šä¹‰æ¡ä»¶ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–æ»¡è¶³ä¸€å®šæ¡ä»¶çš„é”ã€‚å› ä¸ºçº¿ç¨‹é—´ç«äº‰ä¼šæ¶‰åŠåˆ°æ¡ä»¶é”æ£€æµ‹ï¼Œç³»ç»Ÿè°ƒç”¨ä¸Šä¸‹åˆ‡æ¢é¢‘ç¹å¯¼è‡´è€—æ—¶æ˜¯å‡ ä¸ªé”é‡Œæœ€é•¿çš„ã€‚ OSSpinLockï¼šè‡ªæ—‹é”ï¼Œä¸è¿›å…¥å†…æ ¸ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½æœ€é«˜ï¼Œä½†æŠ¢å å¤šæ—¶ä¼šå ç”¨è¾ƒå¤šcpuï¼Œå¥½ç‚¹å¤šï¼Œè¿™æ—¶ä½¿ç”¨pthread_mutexè¾ƒå¥½ã€‚ pthread_mutex_tï¼šåŒæ­¥é”åŸºäºCè¯­è¨€ï¼Œåº•å±‚apiæ€§èƒ½é«˜ï¼Œä½¿ç”¨æ–¹æ³•å’Œå…¶å®ƒçš„ç±»ä¼¼ã€‚ @synchronizedï¼šæ›´åŠ ç®€å•ã€‚ dispatch_suspendå’Œdispatch_resumeæŒ‚èµ·å’Œæ¢å¤é˜Ÿåˆ—dispatch_suspendè¿™é‡ŒæŒ‚èµ·ä¸ä¼šæš‚åœæ­£åœ¨æ‰§è¡Œçš„blockï¼Œåªæ˜¯èƒ½å¤Ÿæš‚åœè¿˜æ²¡æ‰§è¡Œçš„blockã€‚ dispatch_set_contextå’Œdispatch_get_contextGCDæ·±å…¥æ“ä½œç¼“å†²åŒºï¼šdispatch_data_tåŸºäºé›¶ç¢çš„å†…å­˜åŒºåŸŸï¼Œä½¿ç”¨dispatch_data_applyæ¥éå†ï¼Œè¿˜å¯ä»¥ç”¨dispatch_data_create_subrangeæ¥åˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ‹·è´çš„å­åŒºåŸŸI/Oè°ƒåº¦ï¼šä½¿ç”¨GCDæä¾›çš„dispatch_io_readï¼Œdispatch_io_writeå’Œdispatch_io_closeæµ‹è¯•ï¼šä½¿ç”¨dispatch_benchmarkå°å·¥å…·åŸå­æ“ä½œï¼š libkern/OSAtomic.hé‡Œå¯ä»¥æŸ¥çœ‹é‚£äº›å‡½æ•°ï¼Œç”¨äºåº•å±‚å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚ GCDæ­»é”å½“å‰ä¸²è¡Œé˜Ÿåˆ—é‡Œé¢åŒæ­¥æ‰§è¡Œå½“å‰ä¸²è¡Œé˜Ÿåˆ—å°±ä¼šæ­»é”ï¼Œè§£å†³çš„æ–¹æ³•å°±æ˜¯å°†åŒæ­¥çš„ä¸²è¡Œé˜Ÿåˆ—æ”¾åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±èƒ½å¤Ÿè§£å†³ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556- (void)deadLockCase1 &#123; NSLog(@&quot;1&quot;); //ä¸»é˜Ÿåˆ—çš„åŒæ­¥çº¿ç¨‹ï¼ŒæŒ‰ç…§FIFOçš„åŸåˆ™ï¼ˆå…ˆå…¥å…ˆå‡ºï¼‰ï¼Œ2æ’åœ¨3åé¢ä¼šç­‰3æ‰§è¡Œå®Œï¼Œä½†å› ä¸ºåŒæ­¥çº¿ç¨‹ï¼Œ3åˆè¦ç­‰2æ‰§è¡Œå®Œï¼Œç›¸äº’ç­‰å¾…æˆä¸ºæ­»é”ã€‚ dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;);&#125;- (void)deadLockCase2 &#123; NSLog(@&quot;1&quot;); //3ä¼šç­‰2ï¼Œå› ä¸º2åœ¨å…¨å±€å¹¶è¡Œé˜Ÿåˆ—é‡Œï¼Œä¸éœ€è¦ç­‰å¾…3ï¼Œè¿™æ ·2æ‰§è¡Œå®Œå›åˆ°ä¸»é˜Ÿåˆ—ï¼Œ3å°±å¼€å§‹æ‰§è¡Œ dispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;);&#125;- (void)deadLockCase3 &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); NSLog(@&quot;1&quot;); dispatch_async(serialQueue, ^&#123; NSLog(@&quot;2&quot;); //ä¸²è¡Œé˜Ÿåˆ—é‡Œé¢åŒæ­¥ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—å°±ä¼šæ­»é” dispatch_sync(serialQueue, ^&#123; NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); &#125;); NSLog(@&quot;5&quot;);&#125;- (void)deadLockCase4 &#123; NSLog(@&quot;1&quot;); dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; NSLog(@&quot;2&quot;); //å°†åŒæ­¥çš„ä¸²è¡Œé˜Ÿåˆ—æ”¾åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±èƒ½å¤Ÿè§£å†³ dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); &#125;); NSLog(@&quot;5&quot;);&#125;- (void)deadLockCase5 &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; NSLog(@&quot;1&quot;); //å›åˆ°ä¸»çº¿ç¨‹å‘ç°æ­»å¾ªç¯åé¢å°±æ²¡æ³•æ‰§è¡Œäº† dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); //æ­»å¾ªç¯ while (1) &#123; // &#125;&#125; GCDå®é™…ä½¿ç”¨FMDBå¦‚ä½•ä½¿ç”¨dispatch_queue_set_specificå’Œdispatch_get_specificæ¥é˜²æ­¢æ­»é”ä½œç”¨ç±»ä¼¼objc_setAssociatedObjectè·Ÿobjc_getAssociatedObject1234567891011static const void * const kDispatchQueueSpecificKey = &amp;kDispatchQueueSpecificKey;//åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—ï¼Œæ‰€æœ‰æ•°æ®åº“çš„æ“ä½œéƒ½åœ¨è¿™ä¸ªé˜Ÿåˆ—é‡Œ_queue = dispatch_queue_create([[NSString stringWithFormat:@&quot;fmdb.%@&quot;, self] UTF8String], NULL);//æ ‡è®°é˜Ÿåˆ—dispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge void *)self, NULL);//æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€ä¸ªé˜Ÿåˆ—æ¥é¿å…æ­»é”çš„æ–¹æ³•- (void)inDatabase:(void (^)(FMDatabase *db))block &#123; FMDatabaseQueue *currentSyncQueue = (__bridge id)dispatch_get_specific(kDispatchQueueSpecificKey); assert(currentSyncQueue != self &amp;&amp; &quot;inDatabase: was called reentrantly on the same queue, which would lead to a deadlock&quot;);&#125; DTCoreTextä½¿ç”¨GCDåŠ å¿«è§£æé€Ÿåº¦DTCoreTexté‡‡ç”¨çš„æ˜¯SAXè§£æï¼ŒiOSè‡ªå¸¦äº†XML/HTMLçš„è§£æå¼•æ“libxmlï¼Œæä¾›äº†ä¸¤ä¸ªè§£ææ¥å£ï¼ŒDOMè§£æå’ŒSAXè§£æï¼Œå‰è€…ä½¿ç”¨ç®€å•ä½†æ˜¯å ç”¨å†…å­˜å¤šï¼ŒSAXè§£æç”±äºä¸ä¼šè¿”å›ä¸€ä¸ªdomæ ‘ï¼Œé‡‡ç”¨çš„æ˜¯æŸ¥åˆ°ä¸€ä¸ªæ ‡ç­¾æ¯”å¦‚å›è°ƒstartElementæ–¹æ³•ç¢°åˆ°å†…å®¹å°±å›è°ƒ_charactersç¢°åˆ°ç±»ä¼¼å°±å›è°ƒendElementè¿™æ ·çš„æ–¹å¼ã€‚ æ ¹æ®è¿™ç§è§£ææ–¹å¼DTCoreTextä½¿ç”¨å¤šçº¿ç¨‹è§£æèƒ½å¤Ÿæ›´å¿«çš„è§£æï¼ŒDTHTMLAttributedStringBuilderä½¿ç”¨ä¸‰ä¸ªdispatch_queue _dataParsingQueueï¼šè§£æhtmlçš„ _treeBuildingQueueï¼šç”Ÿæˆdomæ ‘çš„ _stringAssemblyQueueï¼šç»„è£…NSAttributeStringçš„ è·å–ä¸‰ä¸ªé˜Ÿåˆ—å…¨éƒ¨å®Œæˆé‡‡ç”¨äº†dispatch_groupçš„dispatch_group_waitè¿™ç§é˜»å¡åŒæ­¥æ–¹å¼æ¥è¿”å›ç»“æœã€‚ iOSç³»ç»Ÿç‰ˆæœ¬æ–°ç‰¹æ€§iOS8æ–°åŠ äº†ä¸€ä¸ªåŠŸèƒ½å«Quality of Service(QoS)ï¼Œé‡Œé¢æä¾›äº†ä¸€ä¸‹å‡ ä¸ªæ›´å®¹æ˜“ç†è§£çš„æšä¸¾åæ¥ä½¿ç”¨user interactiveï¼Œuser initiatedï¼Œutilityå’Œbackgroundã€‚ä¸‹é¢çš„è¡¨åšäº†å¯¹æ¯” Global queue Corresponding QoS class è¯´æ˜ Main thread NSQualityOfServiceUserInteractive UIç›¸å…³ï¼Œäº¤äº’ç­‰ DISPATCH_QUEUE_PRIORITY_HIGH NSQualityOfServiceUserInitiated ç”¨æˆ·å‘èµ·éœ€è¦é©¬ä¸Šå¾—åˆ°ç»“æœè¿›è¡Œåç»­ä»»åŠ¡ DISPATCH_QUEUE_PRIORITY_DEFAULT NSQualityOfServiceDefault é»˜è®¤çš„ä¸åº”è¯¥ä½¿ç”¨è¿™ä¸ªè®¾ç½®ä»»åŠ¡ DISPATCH_QUEUE_PRIORITY_LOW NSQualityOfServiceUtility èŠ±è´¹æ—¶é—´ç¨å¤šæ¯”å¦‚ä¸‹è½½ï¼Œéœ€è¦å‡ ç§’æˆ–å‡ åˆ†é’Ÿçš„ DISPATCH_QUEUE_PRIORITY_BACKGROUND NSQualityOfServiceBackground ä¸å¯è§åœ¨åå°çš„æ“ä½œå¯èƒ½éœ€è¦å¥½å‡ åˆ†é’Ÿç”šè‡³å‡ å°æ—¶çš„]]></content>
      <tags>
        <tag>GCD (Objective-Cé«˜çº§ç¼–ç¨‹ï¼šiOSä¸OS Xå¤šçº¿ç¨‹å’Œå†…å­˜ç®¡ç†)</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CocoaPodsåˆ©ç”¨sourectreeå‘å¸ƒè‡ªå·±çš„ç§æœ‰åº“]]></title>
    <url>%2F2017%2F10%2F21%2FCocoaPods%E5%88%A9%E7%94%A8sourectree%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E7%A7%81%E6%9C%89%E5%BA%93%2F</url>
    <content type="text"><![CDATA[1.åˆ›å»ºPodé¡¹ç›®å·¥ç¨‹æœ€è¿‘è¢«å…¬å¸é¡¹ç›®å¿™çš„å–˜ä¸è¿‡èµ·æ¥ï¼Œæœ‰å¥½å‡ å¤©æ²¡æ›´æ–°åšå®¢äº†ï¼Œä½†å¿ƒé‡Œä¸€ç›´æƒ¦è®°ç€è¿™äº‹ï¼Œå›æ¥çš„æ—¶å€™å¤ªç´¯äº†ï¼Œåƒå®Œé¥­å°±ç¡äº†ï¼Œåªèƒ½å‘¨æœ«æ¥æ›´æ–°äº†ã€‚ã€‚ã€‚ 1.cdè¿›å…¥è¦åˆ›å»ºé¡¹ç›®çš„ç›®å½•ç„¶å æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ 1234#pod lib create [é¡¹ç›®å]$pod lib create TBFontAdjust æ¥ç€åœ¨Terminalæ§åˆ¶å°ä¼šè¾“å‡º5ä¸ªé—®é¢˜ï¼š 1.What language do you want to use?? [ Swift / ObjC ] ObjC ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯é—®ä½ é€‰æ‹©Swiftè¿˜æ˜¯Objcæ„å»ºé¡¹ç›®ã€‚æ­¤æ•™ç¨‹ é€‰çš„æ˜¯ObjC 2.Would you like to include a demo application with your library? [ Yes / No ] Yes ç¬¬äºŒä¸ªé—®é¢˜é—®ä½ æ˜¯å¦éœ€è¦åˆ›å»ºä¸€ä¸ªDemoé¡¹ç›®ï¼Œæ­¤æ•™ç¨‹é€‰çš„æ˜¯Yes 3.Which testing frameworks will you use? [ Specta / Kiwi / None ] None ç¬¬ä¸‰ä¸ªé—®é¢˜è®©ä½ æ˜¯å¦é€‰æ‹©ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œæ­¤æ•™ç¨‹é€‰ None 4.Would you like to do view based testing? [ Yes / No ] Yes 5.What is your class prefix? tdb å¡«å†™å®Œæˆåï¼Œä¼šè‡ªåŠ¨æ‰“å¼€å·¥ç¨‹ã€‚ 2.é…ç½®podå·¥ç¨‹1.é¦–å…ˆå¾—pod å·¥ç¨‹pushåˆ°è¿œç¨‹ä»“åº“ï¼Œæˆ‘é€‰ç”¨sourectreeæ¯”è¾ƒç›´è§‚ æœ¬åœ°-&gt;+æ–°ä»“åº“-&gt;æ·»åŠ å·²ç»å­˜åœ¨çš„ä»“åº“ å¯¼å…¥åï¼Œç‚¹å‡»å³é”®å‘å¸ƒåˆ°è¿œç¨‹ æ ¹æ®éœ€æ±‚é€‰æ‹©ç§æœ‰ï¼ˆgithubè¦æ”¶è´¹ï¼‰è¿˜æ˜¯å…¬æœ‰ å‘å¸ƒåï¼Œç‚¹å‡»è¿›é¡¹ç›®ï¼Œç»™é¡¹ç›®åŠ ä¸€ä¸ªæ ‡ç­¾ 0.1.0ï¼ˆè¿™ä¸ªè¦ä¸podspecä¸€è‡´ï¼‰æ ‡ç­¾æ¨é€åˆ°è¿œç¨‹ ç„¶åï¼Œç™»å½•githubå°†ä¸‹è½½åœ°å€copyå‡ºæ¥ï¼Œç”¨æ¥å¡«å†™é…ç½®ä¿¡æ¯ã€‚ 2.é…ç½®123456789101112131415161718192021222324252627282930313233343536373839404142Pod::Spec.new do |s| s.name = &apos;TBFontAdjust&apos;//é¡¹ç›®å s.version = &apos;0.1.0&apos;//ç‰ˆæœ¬ s.summary = &apos;iOS adjust test&apos;//ç®€ä»‹# This description is used to generate tags and improve search results.# * Think: What does it do? Why did you write it? What is the focus?# * Try to keep it short, snappy and to the point.# * Write the description between the DESC delimiters below.# * Finally, don&apos;t worry about the indent, CocoaPods strips it!//æè¿° s.description = &lt;&lt;-DESCæµ‹è¯• DESC s.homepage = &apos;https://github.com/bobtaocool/TBFontAdjust&apos; # s.screenshots = &apos;www.example.com/screenshots_1&apos;, &apos;www.example.com/screenshots_2&apos; #å¼€æºåè®® s.license = &#123; :type =&gt; &apos;MIT&apos;, :file =&gt; &apos;LICENSE&apos; &#125; #ä½œè€… s.author = &#123; &apos;TDB&apos; =&gt; &apos;1639008265@qq.com&apos; &#125; #æºä»£ç çš„é“¾æ¥åœ°å€ s.source = &#123; :git =&gt; &apos;https://github.com/bobtaocool/TBFontAdjust.git&apos;, :tag =&gt; s.version.to_s &#125; # s.social_media_url = &apos;https://twitter.com/&lt;TWITTER_USERNAME&gt;&apos; #æ”¯æŒçš„å¹³å°åŠç‰ˆæœ¬ s.ios.deployment_target = &apos;8.0&apos; #èµ„æºæ–‡ä»¶åœ°å€ï¼ˆæŠŠä½ çš„åº“ä»£ç æ”¾åœ¨è¿™ä¸ªClassesï¼‰ s.source_files = &apos;TBFontAdjust/Classes/**/*&apos; # s.resource_bundles = &#123; # &apos;TBFontAdjust&apos; =&gt; [&apos;TBFontAdjust/Assets/*.png&apos;] # &#125;#å…¬å¼€å¤´æ–‡ä»¶åœ°å€ # s.public_header_files = &apos;Pod/Classes/**/*.h&apos;#æ‰€éœ€çš„frameworkï¼Œå¤šä¸ªç”¨é€—å·éš”å¼€ # s.frameworks = &apos;UIKit&apos;, &apos;MapKit&apos;#ä¾èµ–å…³ç³»ï¼Œè¯¥é¡¹ç›®æ‰€ä¾èµ–çš„å…¶ä»–åº“ï¼Œå¦‚æœæœ‰å¤šä¸ªéœ€è¦å¡«å†™å¤šä¸ªs.dependency # s.dependency &apos;AFNetworking&apos;, &apos;~&gt; 2.3&apos;end é…ç½®å®Œæˆå¯ä»¥è¿›è¡ŒéªŒè¯ pod lib lint å¦‚å‡ºç°è­¦å‘Šï¼šå¯ä»¥ podspec â€“use-libraries â€“allow-warnings å¦‚æœå‡ºç°passed validationè¯´æ˜é…ç½®æ²¡é—®é¢˜ é…ç½®å¥½åï¼Œsourectree æäº¤,æ¨é€åˆ°è¿œç¨‹ã€‚ 3.æœ¬åœ°æµ‹è¯•æ‰“å¼€Exampleå·¥ç¨‹ç›®å½•Podfileæ–‡ä»¶ä¿®æ”¹ä¸‹pod çš„å¼•ç”¨ 12#pod &apos;MyLib&apos;, :path =&gt; &apos;../&apos; # æŒ‡å®šè·¯å¾„pod &apos;TBFontAdjust&apos;, :podspec =&gt; &apos;../TBFontAdjust.podspec&apos; ç„¶ååœ¨Exampleå·¥ç¨‹ç›®å½•ä¸‹æ‰§è¡Œpod updateå‘½ä»¤ æ‰“å¼€é¡¹ç›®å·¥ç¨‹ï¼Œç°åœ¨å¯ä»¥çœ‹åˆ°åº“æ–‡ä»¶éƒ½è¢«åŠ è½½åˆ°Podså­é¡¹ç›®ä¸­äº†. 2.åˆ›å»ºç§æœ‰çš„ä»“åº“(Spec Repo)æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:(åº“åï¼Œåœ°å€éœ€å’Œé…ç½®æ–‡ä»¶å¡«å†™ä¸€æ ·) pod repo add åº“å åœ°å€ TBFontAdjust.podspecæäº¤åˆ°è¿œç¨‹Spec Repoä»“åº“ä¸­cdè¿›å…¥TBFontAdjusté¡¹ç›®æ ¹ç›®å½• 12# pod repo push [Repoå] [podspec æ–‡ä»¶åå­—]$ pod repo push TBFontAdjust TBFontAdjust.podspec å¦‚æœæäº¤æˆåŠŸå¯ä»¥åœ¨~/.cocoapods/repos/MySpecsç›®å½•ä¸‹æŸ¥çœ‹ ä¸Šä¼ é¡¹ç›®åˆ°Cocoapodså®˜æ–¹çš„ä»“åº“é‡Œå»1pod trunk push TBFontAdjust.podspec å¦‚æœå‡ºç°[!] You need to register a session first æ‰§è¡Œå‘½ä»¤æ³¨å†Œ: pod trunk register xxxx@qq.com tdb å†æ¬¡æ‰§è¡Œ:pod trunk push TBFontAdjust.podspec 123456789101112131415Updating spec repo `master`Validating podspec -&gt; TBFontAdjust (0.1.0)Updating spec repo `master`-------------------------------------------------------------------------------- ğŸ‰ Congrats ğŸš€ TBFontAdjust (0.1.0) successfully published ğŸ“… October 21st, 08:47 ğŸŒ https://cocoapods.org/pods/TBFontAdjust ğŸ‘ Tell your friends!--------------------------------------------------------------------------------bogon:TBFontAdjust bob$ è¯´æ˜æäº¤æˆåŠŸäº†. 3.æŸ¥çœ‹æ“ä½œæ˜¯å¦æˆåŠŸpod search TBFontAdjust æœ‰æ—¶å€™ä¼šé‡åˆ°æœç´¢ä¸åˆ°çš„æƒ…å†µ: [!] Unable to find a pod with name, author, summary, or description matching TBFontAdjust å½“é‡åˆ°ä¸Šé¢è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼šæ‰§è¡Œpod setupã€‚æ‰§è¡Œè¯¥æŒ‡ä»¤ä¹‹åï¼Œæˆ‘ä»¬å†è¯•è¯•â€œpod search GofWebImageâ€ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæœç´¢å‡ºç»“æœï¼Œé‚£ä¹ˆä¸éœ€è¦åšä¸‹é¢æ­¥éª¤çš„æ“ä½œï¼›å¦‚æœè¿˜æ˜¯æœç´¢ä¸åˆ°ï¼Œé‚£ä¹ˆç»§ç»­åç»­æ­¥éª¤ï¼›åˆ é™¤~/Library/Caches/CocoaPodsç›®å½•ä¸‹çš„s å¦‚æœå‡ºç°è¿™ä¸ª [!] An unexpected version directory Assets was encountered for the è§£å†³æ–¹æ³•:è¿›å…¥æŒ‡å®šæ–‡ä»¶å¤¹reposæŠŠTBFontAdjuståˆ é™¤å³å¯ã€‚ å‚è€ƒé“¾æ¥:CocoaPodsåº”ç”¨ç¯‡ä¹‹æ­å»ºå¹¶å‘å¸ƒè‡ªå·±çš„ç§æœ‰åº“ åˆ©ç”¨CocoaPodsåˆ›å»ºç§æœ‰åº“]]></content>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CocoaPodså®‰è£…åŠå‡ºç°çš„é—®é¢˜æ€»ç»“]]></title>
    <url>%2F2017%2F10%2F16%2FCocoaPods%E5%AE%89%E8%A3%85%E5%8F%8A%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Cocopod æ˜¯iOSå¼€å‘ä¸­å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ç®¡ç†å·¥å…·ï¼Œé€šè¿‡CocoaPodsï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸‰æ–¹çš„ä¾èµ–åº“ç»Ÿä¸€ç®¡ç†èµ·æ¥ï¼Œé…ç½®å’Œæ›´æ–°åªéœ€è¦é€šè¿‡ç®€å•çš„å‡ è¡Œå‘½ä»¤å³å¯å®Œæˆï¼Œå¤§å¤§çš„æé«˜äº†å®é™…å¼€å‘ä¸­çš„å·¥ä½œæ•ˆç‡ï¼ŒæŒæ¡CocoaPodsçš„ä½¿ç”¨æ˜¯å¿…ä¸å¯å°‘çš„åŸºæœ¬æŠ€èƒ½äº†ã€‚ å®‰è£…CocoaPods1.å®‰è£…å‰å…ˆå‡çº§Rubyç¯å¢ƒ12$sudo gem update â€”system ç”±äºå¢™çš„åŸå› ä¼šå¯¼è‡´è¿™ä¸€æ­¥éå¸¸ç¼“æ…¢,å¯ä»¥ç”¨æ·˜å®çš„Rubyé•œåƒæ¥è®¿é—®è¯¥ç½‘ç«™ 12$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/ æŸ¥çœ‹æ˜¯å¦æ›´æ¢æˆåŠŸ: 12gem sources -l å®‰è£…Cocoapods1sudo gem install cocoapods è¿™ä¸ªæ—¶å€™ä¼šæç¤ºä½ è¾“å…¥å¯†ç  è¾“å…¥åå¼€å§‹å®‰è£…â€¦ å®‰è£…æˆåŠŸå æŸ¥çœ‹ç‰ˆæœ¬ 1$ pod --version ä½¿ç”¨CocoaPodsæœç´¢ç›®æ ‡åº“12$ pod search åº“å åˆ›å»ºPodfile1234$ cd /é¡¹ç›®æ–‡ä»¶touch Podfile //åˆ›å»ºPodfile åˆ›å»ºæˆåŠŸåä¼šåœ¨ç›®å½•æ–‡ä»¶å¤¹çœ‹åˆ° ç¼–è¾‘Podfile12$ vim Podfile å°†æœç´¢å‡ºæ¥çš„åº“ï¼Œæ‹·è´è¿›å»é…ç½®å¦‚ä¸‹å›¾: å…·ä½“å‚è€ƒ:cocoapods 123platform :ios, â€˜7.0â€™ ï¼ï¼æ”¯æŒçš„æœ€ä½ç‰ˆæœ¬inhibit_all_warnings! //å»é™¤ç¬¬ä¸‰æ–¹çš„è­¦å‘Šuse_frameworks! //ä¿®æ”¹å¼•å…¥æ–¹å¼ï¼ŒåŠ äº†è¿™å¥å¼•å…¥ä½¿ç”¨#import â€ â€ ; æœªåŠ ä½¿ç”¨#import &lt; &gt; æ‰§è¡Œå®‰è£…ï¼æ›´æ–°123pod installpod update CocoaPods å®ç°å¿«é€Ÿæ›´æ–°ä¸æ£€æŸ¥CocoaPods specsæ›´æ–° 12pod install --verbose --no-repo-updatepod update --verbose --no-repo-update å‡çº§CocoaPods12345671.æ·»åŠ é•œåƒ$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/$ gem sources -l2.å‡çº§ gemæŸ¥çœ‹gem gem --versionsudo gem update --system 1-2è¿™ä¸ªå’Œå®‰è£…æµç¨‹å·®ä¸å¤šï¼Œä¸å†é‡å¤ 123.å‡çº§cocopodsudo gem install -n /usr/local/bin cocoapods --pre 1234.è®¾ç½®pod ä»“åº“pod setup 125.æŸ¥çœ‹ç‰ˆæœ¬pod --version CocoaPods ä½¿ç”¨ä¸­çš„ä¸€äº›é—®é¢˜CocoaPods æœç´¢ä¸åˆ°æœ€æ–°çš„ç‰ˆæœ¬åº“1231.cocoapodsçš„ç‰ˆæœ¬è¿‡ä½2.è¿˜æ²¡æœ‰æ›´æ–°æœ¬åœ°ä»“åº“ æŒ‰ç…§ä¸Šè¿°æ›´æ–°cocoapodså³å¯! githubä¸Šé¡¹ç›®ä¸‹è½½æ‰“å¼€å‡ºé”™123diff: /../Podfile.lock: No such file or directory diff: Manifest.lock: No such file or directory error: The sandbox is not in sync with the Podfile.lock. Run &apos;pod install&apos; or update your CocoaPods installation.` 1.å…³é—­å½“å‰çš„å·¥ä½œç©ºé—´ï¼Œåˆ é™¤æ‰æ–‡ä»¶å¤¹ä¸­çš„workspace2.ç„¶åé‡æ–°pod installã€‚3.installå®Œæˆä¹‹åï¼Œé€šè¿‡workspaceæ‰“å¼€å·¥ä½œç©ºé—´ï¼Œclean+buildå³å¯ï¼š 12rm -rf MyProject.xcworkspace pod install å¤šä¸ªxcodeå‡ºç°é—®é¢˜1sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer é‚£ä¹ˆä½ çš„å‘½ä»¤è¡Œå°±è¦ä¿®æ”¹ä¸€ä¸‹ï¼š 1sudo xcode-select -switch /Applications/Xcode 7.3.1.app/Contents/Developer æ ¹æ®ä½ é»˜è®¤çš„xcodeæ¥ä¿®æ”¹åœ¨/Applications/å’Œ/Contents/Developerä¸­é—´çš„appçš„åå­—ï¼Œå¦‚æœä½ é»˜è®¤çš„æ˜¯Xcode x.x.x.appï¼Œä¸­é—´å°±è¦æ›¿æ¢æ‰å“Ÿï¼]]></content>
      <tags>
        <tag>å·¥å…·æ¨è</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MarkDownçš„åŸºæœ¬ä½¿ç”¨]]></title>
    <url>%2F2017%2F10%2F12%2FMarkDown%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[å‰å‡ å¤©æ­å»ºå¥½äº†ä¸ªäººç½‘ç«™ï¼Œä¹°äº†åŸŸåï¼ŒæŠ˜è…¾äº†å¥½å‡ ä¸ªæ™šä¸Šï¼Œç»ˆäºå¾€äº‹ä¿±å¤‡ï¼Œåªæ¬ ä¸œé£äº†ã€‚ä¼°æ‘¸ç€ç¬¬ä¸€ç¯‡å†™äº›å•¥ï¼Œæ—¢ç„¶éœ€è¦Markdownæ¥ç¼–å†™ï¼Œé‚£å°±ä»markdownå¼€åˆ€å§! å†™åšå®¢å¿…é¡»è¦æœ‰ä¸€å®šçš„è‡ªåˆ¶åŠ›ï¼Œæ‰èƒ½åšæŒä¸‹å»ï¼Œä¸Šç­æ²¡æ³•å†™ï¼Œåªèƒ½ä¸‹ç­æŠ½ç‚¹æ—¶é—´å‡ºæ¥æ€»ç»“ä¸€ä¸‹ï¼Œç¯‡å¹…ï¼Œæ•°é‡ä¸å®šï¼Œç»è¿‡å²æœˆæ²‰æ·€çš„å‡ºæ¥çš„æ‰æ˜¯å¥½åšå®¢ã€‚ å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ï¼ æˆ‘ä½¿ç”¨çš„å·¥å…·æ˜¯:Atom ä¸‹é¢è¿›å…¥æ­£é¢˜ï¼š æ ‡é¢˜123456#ä¸€çº§æ ‡é¢˜##äºŒçº§æ ‡é¢˜###ä¸‰çº§æ ‡é¢˜####å››çº§æ ‡é¢˜#####äº”åŠæ ‡é¢˜ å±•ç¤ºæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å­—ä½“123456**ç²—ä½“***æ–œä½“****æ–œä½“+ç²—ä½“*** æ•ˆæœå¦‚ä¸‹: åˆ†å‰²çº¿ä½ å¯ä»¥åœ¨ä¸€è¡Œä¸­ç”¨ä¸‰ä¸ªä»¥ä¸Šçš„æ˜Ÿå·ã€å‡å·ã€åº•çº¿æ¥å»ºç«‹ä¸€ä¸ªåˆ†éš”çº¿ï¼Œè¡Œå†…ä¸èƒ½æœ‰å…¶ä»–ä¸œè¥¿ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨æ˜Ÿå·æˆ–æ˜¯å‡å·ä¸­é—´æ’å…¥ç©ºæ ¼ã€‚ä¸‹é¢æ¯ç§å†™æ³•éƒ½å¯ä»¥å»ºç«‹åˆ†éš”çº¿ï¼š 123456789101112* * *********- - -ä¸–ç•Œä½ å¥½---------------------------------------* ä¸–ç•Œä½ å¥½ åæ–œæ å¯ä»¥åˆ©ç”¨åæ–œæ æ¥æ’å…¥ä¸€äº›åœ¨è¯­æ³•ä¸­æœ‰å…¶å®ƒæ„ä¹‰çš„ç¬¦å·ï¼Œä¾‹å¦‚ï¼šå¦‚æœä½ æƒ³è¦ç”¨æ˜Ÿå·åŠ åœ¨æ–‡å­—æ—è¾¹çš„æ–¹å¼æ¥åšå‡ºå¼ºè°ƒæ•ˆæœï¼ˆä½†ä¸ç”¨ æ ‡ç­¾ï¼‰ï¼Œä½ å¯ä»¥åœ¨æ˜Ÿå·çš„å‰é¢åŠ ä¸Šåæ–œæ ï¼š 12\*literal asterisks\* *literal asterisks* å›¾ç‰‡ä¸é“¾æ¥å›¾ç‰‡123![å‘½å](å›¾ç‰‡é“¾æ¥)æ¯”å¦‚:![å­—ä½“](http://oxv4ynhvc.bkt.clouddn.com/MKFont.png) é“¾æ¥123[é“¾æ¥æ˜¾ç¤ºæ–‡å­—](é“¾æ¥åœ°å€)æ¯”å¦‚:[åšå®¢](http://taodongbo.cn) åšå®¢åœ°å€: åšå®¢ åˆ—è¡¨æ— åº12345* **åŠ ç²—**ä¸¾ä¸ªä¾‹å­* è¢«æ˜Ÿæ˜ŸåŒ…å›´çš„åŠ é†‹**åŠ ç²—**- **å‡å·**ä¸€æ ·çš„æ•ˆæœ+ **åŠ å·**ä¸€æ ·çš„æ•ˆæœ æ•ˆæœå¦‚ä¸‹ æœ‰åº1234561.æ–‡æœ¬2.æ ‡é¢˜3.å›¾ç‰‡ å¼•ç”¨12&gt; å™«ååš±ï¼Œå±ä¹é«˜å“‰ï¼èœ€é“ä¹‹éš¾ï¼Œéš¾äºä¸Šé’å¤©ï¼èš•ä¸›åŠé±¼å‡«ï¼Œå¼€å›½ä½•èŒ«ç„¶ï¼å°”æ¥å››ä¸‡å…«åƒå²ï¼Œä¸ä¸ç§¦å¡é€šäººçƒŸã€‚è¥¿å½“å¤ªç™½æœ‰é¸Ÿé“ï¼Œå¯ä»¥æ¨ªç»å³¨çœ‰å·…ã€‚åœ°å´©å±±æ‘§å£®å£«æ­»ï¼Œç„¶åå¤©æ¢¯çŸ³æ ˆç›¸é’©è¿ã€‚ä¸Šæœ‰å…­é¾™å›æ—¥ä¹‹é«˜æ ‡ï¼Œä¸‹æœ‰å†²æ³¢é€†æŠ˜ä¹‹ æ•ˆæœå¦‚ä¸‹: ä»£ç å¼•ç”¨ä¸€å¥ä»£ç ä¸å¤šå¥çš„åŒºåˆ«åœ¨äº ` è¿˜æ˜¯ 3ä¸ª` ä¸€å¥ä»£ç 12`[self.view addSubView:label]` ä¸€æ®µä»£ç  å±•ç¤ºæ•ˆæœåˆ†åˆ«å¦‚ä¸‹: è¡¨æ ¼123456|é»˜è®¤|å±…ä¸­|å·¦å¯¹é½|å³å¯¹é½||--|:-:|:-|-:||æµ‹è¯•æ¢è¡Œ\nä¸æ”¯æŒæ¢è¡Œ|æµ‹è¯•1|æµ‹è¯•2|æµ‹è¯•3||*æ–œä½“*|**ç²—ä½“**|***æ–œä½“+ç²—ä½“***|æ­£å¸¸||# ä¸å¯æ”¾æ ‡é¢˜|[å¯æ”¾é“¾æ¥](taodongbo.cn)|![å¯æ”¾å›¾ç‰‡](http://oxv4ynhvc.bkt.clouddn.com/MKYY.png)|`å¯æ”¾ä»£ç  hello word ` ä»¥ä¸Šæ˜¯ä¸€äº›åŸºæœ¬çš„ç”¨æ³•ï¼Œæ›´å¤šå‚è€ƒè¯­æ³•è¯´æ˜]]></content>
      <categories>
        <category>å·¥å…·æ¨è</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>Markdown</tag>
      </tags>
  </entry>
</search>
