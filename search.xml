<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[CocoaPodsÂà©Áî®sourectreeÂèëÂ∏ÉËá™Â∑±ÁöÑÁßÅÊúâÂ∫ì]]></title>
    <url>%2F2017%2F10%2F21%2FCocoaPods%E5%88%A9%E7%94%A8sourectree%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E7%A7%81%E6%9C%89%E5%BA%93%2F</url>
    <content type="text"><![CDATA[1.ÂàõÂª∫PodÈ°πÁõÆÂ∑•Á®ãÊúÄËøëË¢´ÂÖ¨Âè∏È°πÁõÆÂøôÁöÑÂñò‰∏çËøáËµ∑Êù•ÔºåÊúâÂ•ΩÂá†Â§©Ê≤°Êõ¥Êñ∞ÂçöÂÆ¢‰∫ÜÔºå‰ΩÜÂøÉÈáå‰∏ÄÁõ¥ÊÉ¶ËÆ∞ÁùÄËøô‰∫ãÔºåÂõûÊù•ÁöÑÊó∂ÂÄôÂ§™Á¥Ø‰∫ÜÔºåÂêÉÂÆåÈ•≠Â∞±Áù°‰∫ÜÔºåÂè™ËÉΩÂë®Êú´Êù•Êõ¥Êñ∞‰∫Ü„ÄÇ„ÄÇ„ÄÇ 1.cdËøõÂÖ•Ë¶ÅÂàõÂª∫È°πÁõÆÁöÑÁõÆÂΩïÁÑ∂Âêé ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ 1234#pod lib create [È°πÁõÆÂêç]$pod lib create TBFontAdjust Êé•ÁùÄÂú®TerminalÊéßÂà∂Âè∞‰ºöËæìÂá∫5‰∏™ÈóÆÈ¢òÔºö 1.What language do you want to use?? [ Swift / ObjC ] ObjC Á¨¨‰∏Ä‰∏™ÈóÆÈ¢òÊòØÈóÆ‰Ω†ÈÄâÊã©SwiftËøòÊòØObjcÊûÑÂª∫È°πÁõÆ„ÄÇÊ≠§ÊïôÁ®ã ÈÄâÁöÑÊòØObjC 2.Would you like to include a demo application with your library? [ Yes / No ] Yes Á¨¨‰∫å‰∏™ÈóÆÈ¢òÈóÆ‰Ω†ÊòØÂê¶ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™DemoÈ°πÁõÆÔºåÊ≠§ÊïôÁ®ãÈÄâÁöÑÊòØYes 3.Which testing frameworks will you use? [ Specta / Kiwi / None ] None Á¨¨‰∏â‰∏™ÈóÆÈ¢òËÆ©‰Ω†ÊòØÂê¶ÈÄâÊã©‰∏Ä‰∏™ÊµãËØïÊ°ÜÊû∂ÔºåÊ≠§ÊïôÁ®ãÈÄâ None 4.Would you like to do view based testing? [ Yes / No ] Yes 5.What is your class prefix? tdb Â°´ÂÜôÂÆåÊàêÂêéÔºå‰ºöËá™Âä®ÊâìÂºÄÂ∑•Á®ã„ÄÇ 2.ÈÖçÁΩÆpodÂ∑•Á®ã1.È¶ñÂÖàÂæópod Â∑•Á®ãpushÂà∞ËøúÁ®ã‰ªìÂ∫ìÔºåÊàëÈÄâÁî®sourectreeÊØîËæÉÁõ¥ËßÇ Êú¨Âú∞-&gt;+Êñ∞‰ªìÂ∫ì-&gt;Ê∑ªÂä†Â∑≤ÁªèÂ≠òÂú®ÁöÑ‰ªìÂ∫ì ÂØºÂÖ•ÂêéÔºåÁÇπÂáªÂè≥ÈîÆÂèëÂ∏ÉÂà∞ËøúÁ®ã Ê†πÊçÆÈúÄÊ±ÇÈÄâÊã©ÁßÅÊúâÔºàgithubË¶ÅÊî∂Ë¥πÔºâËøòÊòØÂÖ¨Êúâ ÂèëÂ∏ÉÂêéÔºåÁÇπÂáªËøõÈ°πÁõÆÔºåÁªôÈ°πÁõÆÂä†‰∏Ä‰∏™Ê†áÁ≠æ 0.1.0ÔºàËøô‰∏™Ë¶Å‰∏épodspec‰∏ÄËá¥ÔºâÊ†áÁ≠æÊé®ÈÄÅÂà∞ËøúÁ®ã ÁÑ∂ÂêéÔºåÁôªÂΩïgithubÂ∞Ü‰∏ãËΩΩÂú∞ÂùÄcopyÂá∫Êù•ÔºåÁî®Êù•Â°´ÂÜôÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ 2.ÈÖçÁΩÆ123456789101112131415161718192021222324252627282930313233343536373839404142Pod::Spec.new do |s| s.name = &apos;TBFontAdjust&apos;//È°πÁõÆÂêç s.version = &apos;0.1.0&apos;//ÁâàÊú¨ s.summary = &apos;iOS adjust test&apos;//ÁÆÄ‰ªã# This description is used to generate tags and improve search results.# * Think: What does it do? Why did you write it? What is the focus?# * Try to keep it short, snappy and to the point.# * Write the description between the DESC delimiters below.# * Finally, don&apos;t worry about the indent, CocoaPods strips it!//ÊèèËø∞ s.description = &lt;&lt;-DESCÊµãËØï DESC s.homepage = &apos;https://github.com/bobtaocool/TBFontAdjust&apos; # s.screenshots = &apos;www.example.com/screenshots_1&apos;, &apos;www.example.com/screenshots_2&apos; #ÂºÄÊ∫êÂçèËÆÆ s.license = &#123; :type =&gt; &apos;MIT&apos;, :file =&gt; &apos;LICENSE&apos; &#125; #‰ΩúËÄÖ s.author = &#123; &apos;TDB&apos; =&gt; &apos;1639008265@qq.com&apos; &#125; #Ê∫ê‰ª£Á†ÅÁöÑÈìæÊé•Âú∞ÂùÄ s.source = &#123; :git =&gt; &apos;https://github.com/bobtaocool/TBFontAdjust.git&apos;, :tag =&gt; s.version.to_s &#125; # s.social_media_url = &apos;https://twitter.com/&lt;TWITTER_USERNAME&gt;&apos; #ÊîØÊåÅÁöÑÂπ≥Âè∞ÂèäÁâàÊú¨ s.ios.deployment_target = &apos;8.0&apos; #ËµÑÊ∫êÊñá‰ª∂Âú∞ÂùÄÔºàÊää‰Ω†ÁöÑÂ∫ì‰ª£Á†ÅÊîæÂú®Ëøô‰∏™ClassesÔºâ s.source_files = &apos;TBFontAdjust/Classes/**/*&apos; # s.resource_bundles = &#123; # &apos;TBFontAdjust&apos; =&gt; [&apos;TBFontAdjust/Assets/*.png&apos;] # &#125;#ÂÖ¨ÂºÄÂ§¥Êñá‰ª∂Âú∞ÂùÄ # s.public_header_files = &apos;Pod/Classes/**/*.h&apos;#ÊâÄÈúÄÁöÑframeworkÔºåÂ§ö‰∏™Áî®ÈÄóÂè∑ÈöîÂºÄ # s.frameworks = &apos;UIKit&apos;, &apos;MapKit&apos;#‰æùËµñÂÖ≥Á≥ªÔºåËØ•È°πÁõÆÊâÄ‰æùËµñÁöÑÂÖ∂‰ªñÂ∫ìÔºåÂ¶ÇÊûúÊúâÂ§ö‰∏™ÈúÄË¶ÅÂ°´ÂÜôÂ§ö‰∏™s.dependency # s.dependency &apos;AFNetworking&apos;, &apos;~&gt; 2.3&apos;end ÈÖçÁΩÆÂÆåÊàêÂèØ‰ª•ËøõË°åÈ™åËØÅ pod lib lint Â¶ÇÂá∫Áé∞Ë≠¶ÂëäÔºöÂèØ‰ª• podspec ‚Äìuse-libraries ‚Äìallow-warnings Â¶ÇÊûúÂá∫Áé∞passed validationËØ¥ÊòéÈÖçÁΩÆÊ≤°ÈóÆÈ¢ò ÈÖçÁΩÆÂ•ΩÂêéÔºåsourectree Êèê‰∫§,Êé®ÈÄÅÂà∞ËøúÁ®ã„ÄÇ 3.Êú¨Âú∞ÊµãËØïÊâìÂºÄExampleÂ∑•Á®ãÁõÆÂΩïPodfileÊñá‰ª∂‰øÆÊîπ‰∏ãpod ÁöÑÂºïÁî® 12#pod &apos;MyLib&apos;, :path =&gt; &apos;../&apos; # ÊåáÂÆöË∑ØÂæÑpod &apos;TBFontAdjust&apos;, :podspec =&gt; &apos;../TBFontAdjust.podspec&apos; ÁÑ∂ÂêéÂú®ExampleÂ∑•Á®ãÁõÆÂΩï‰∏ãÊâßË°åpod updateÂëΩ‰ª§ ÊâìÂºÄÈ°πÁõÆÂ∑•Á®ãÔºåÁé∞Âú®ÂèØ‰ª•ÁúãÂà∞Â∫ìÊñá‰ª∂ÈÉΩË¢´Âä†ËΩΩÂà∞PodsÂ≠êÈ°πÁõÆ‰∏≠‰∫Ü. 2.ÂàõÂª∫ÁßÅÊúâÁöÑ‰ªìÂ∫ì(Spec Repo)ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§:(Â∫ìÂêçÔºåÂú∞ÂùÄÈúÄÂíåÈÖçÁΩÆÊñá‰ª∂Â°´ÂÜô‰∏ÄÊ†∑) pod repo add Â∫ìÂêç Âú∞ÂùÄ TBFontAdjust.podspecÊèê‰∫§Âà∞ËøúÁ®ãSpec Repo‰ªìÂ∫ì‰∏≠cdËøõÂÖ•TBFontAdjustÈ°πÁõÆÊ†πÁõÆÂΩï 12# pod repo push [RepoÂêç] [podspec Êñá‰ª∂ÂêçÂ≠ó]$ pod repo push TBFontAdjust TBFontAdjust.podspec Â¶ÇÊûúÊèê‰∫§ÊàêÂäüÂèØ‰ª•Âú®~/.cocoapods/repos/MySpecsÁõÆÂΩï‰∏ãÊü•Áúã ‰∏ä‰º†È°πÁõÆÂà∞CocoapodsÂÆòÊñπÁöÑ‰ªìÂ∫ìÈáåÂéª1pod trunk push TBFontAdjust.podspec Â¶ÇÊûúÂá∫Áé∞[!] You need to register a session first ÊâßË°åÂëΩ‰ª§Ê≥®ÂÜå: pod trunk register xxxx@qq.com tdb ÂÜçÊ¨°ÊâßË°å:pod trunk push TBFontAdjust.podspec 123456789101112131415Updating spec repo `master`Validating podspec -&gt; TBFontAdjust (0.1.0)Updating spec repo `master`-------------------------------------------------------------------------------- üéâ Congrats üöÄ TBFontAdjust (0.1.0) successfully published üìÖ October 21st, 08:47 üåé https://cocoapods.org/pods/TBFontAdjust üëç Tell your friends!--------------------------------------------------------------------------------bogon:TBFontAdjust bob$ ËØ¥ÊòéÊèê‰∫§ÊàêÂäü‰∫Ü. 3.Êü•ÁúãÊìç‰ΩúÊòØÂê¶ÊàêÂäüpod search TBFontAdjust ÊúâÊó∂ÂÄô‰ºöÈÅáÂà∞ÊêúÁ¥¢‰∏çÂà∞ÁöÑÊÉÖÂÜµ: [!] Unable to find a pod with name, author, summary, or description matching TBFontAdjust ÂΩìÈÅáÂà∞‰∏äÈù¢ËøôÁßçÊÉÖÂÜµÁöÑÊó∂ÂÄôÔºåÊåâÂ¶Ç‰∏ãÊ≠•È™§ËøõË°åÊìç‰ΩúÔºöÊâßË°åpod setup„ÄÇÊâßË°åËØ•Êåá‰ª§‰πãÂêéÔºåÊàë‰ª¨ÂÜçËØïËØï‚Äúpod search GofWebImage‚ÄùÔºåÂ¶ÇÊûúËÉΩÂ§üÊàêÂäüÊêúÁ¥¢Âá∫ÁªìÊûúÔºåÈÇ£‰πà‰∏çÈúÄË¶ÅÂÅö‰∏ãÈù¢Ê≠•È™§ÁöÑÊìç‰ΩúÔºõÂ¶ÇÊûúËøòÊòØÊêúÁ¥¢‰∏çÂà∞ÔºåÈÇ£‰πàÁªßÁª≠ÂêéÁª≠Ê≠•È™§ÔºõÂà†Èô§~/Library/Caches/CocoaPodsÁõÆÂΩï‰∏ãÁöÑs Â¶ÇÊûúÂá∫Áé∞Ëøô‰∏™ [!] An unexpected version directory Assets was encountered for the Ëß£ÂÜ≥ÊñπÊ≥ï:ËøõÂÖ•ÊåáÂÆöÊñá‰ª∂Â§πreposÊääTBFontAdjustÂà†Èô§Âç≥ÂèØ„ÄÇ ÂèÇËÄÉÈìæÊé•:CocoaPodsÂ∫îÁî®ÁØá‰πãÊê≠Âª∫Âπ∂ÂèëÂ∏ÉËá™Â∑±ÁöÑÁßÅÊúâÂ∫ì Âà©Áî®CocoaPodsÂàõÂª∫ÁßÅÊúâÂ∫ì]]></content>
      <tags>
        <tag>Â∑•ÂÖ∑</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CocoaPodsÂÆâË£ÖÂèäÂá∫Áé∞ÁöÑÈóÆÈ¢òÊÄªÁªì]]></title>
    <url>%2F2017%2F10%2F16%2FCocoaPods%E5%AE%89%E8%A3%85%E5%8F%8A%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Cocopod ÊòØiOSÂºÄÂèë‰∏≠Â∏∏Áî®ÁöÑÁ¨¨‰∏âÊñπÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÈÄöËøáCocoaPodsÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÁ¨¨‰∏âÊñπÁöÑ‰æùËµñÂ∫ìÁªü‰∏ÄÁÆ°ÁêÜËµ∑Êù•ÔºåÈÖçÁΩÆÂíåÊõ¥Êñ∞Âè™ÈúÄË¶ÅÈÄöËøáÁÆÄÂçïÁöÑÂá†Ë°åÂëΩ‰ª§Âç≥ÂèØÂÆåÊàêÔºåÂ§ßÂ§ßÁöÑÊèêÈ´ò‰∫ÜÂÆûÈôÖÂºÄÂèë‰∏≠ÁöÑÂ∑•‰ΩúÊïàÁéáÔºåÊéåÊè°CocoaPodsÁöÑ‰ΩøÁî®ÊòØÂøÖ‰∏çÂèØÂ∞ëÁöÑÂü∫Êú¨ÊäÄËÉΩ‰∫Ü„ÄÇ ÂÆâË£ÖCocoaPods1.ÂÆâË£ÖÂâçÂÖàÂçáÁ∫ßRubyÁéØÂ¢É12$sudo gem update ‚Äîsystem Áî±‰∫éÂ¢ôÁöÑÂéüÂõ†‰ºöÂØºËá¥Ëøô‰∏ÄÊ≠•ÈùûÂ∏∏ÁºìÊÖ¢,ÂèØ‰ª•Áî®Ê∑òÂÆùÁöÑRubyÈïúÂÉèÊù•ËÆøÈóÆËØ•ÁΩëÁ´ô 12$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/ Êü•ÁúãÊòØÂê¶Êõ¥Êç¢ÊàêÂäü: 12gem sources -l ÂÆâË£ÖCocoapods1sudo gem install cocoapods Ëøô‰∏™Êó∂ÂÄô‰ºöÊèêÁ§∫‰Ω†ËæìÂÖ•ÂØÜÁ†Å ËæìÂÖ•ÂêéÂºÄÂßãÂÆâË£Ö‚Ä¶ ÂÆâË£ÖÊàêÂäüÂêé Êü•ÁúãÁâàÊú¨ 1$ pod --version ‰ΩøÁî®CocoaPodsÊêúÁ¥¢ÁõÆÊ†áÂ∫ì12$ pod search Â∫ìÂêç ÂàõÂª∫Podfile1234$ cd /È°πÁõÆÊñá‰ª∂touch Podfile //ÂàõÂª∫Podfile ÂàõÂª∫ÊàêÂäüÂêé‰ºöÂú®ÁõÆÂΩïÊñá‰ª∂Â§πÁúãÂà∞ ÁºñËæëPodfile12$ vim Podfile Â∞ÜÊêúÁ¥¢Âá∫Êù•ÁöÑÂ∫ìÔºåÊã∑Ë¥ùËøõÂéªÈÖçÁΩÆÂ¶Ç‰∏ãÂõæ: ÂÖ∑‰ΩìÂèÇËÄÉ:cocoapods 123platform :ios, ‚Äò7.0‚Äô ÔºèÔºèÊîØÊåÅÁöÑÊúÄ‰ΩéÁâàÊú¨inhibit_all_warnings! //ÂéªÈô§Á¨¨‰∏âÊñπÁöÑË≠¶Âëäuse_frameworks! //‰øÆÊîπÂºïÂÖ•ÊñπÂºèÔºåÂä†‰∫ÜËøôÂè•ÂºïÂÖ•‰ΩøÁî®#import ‚Äù ‚Äù ; Êú™Âä†‰ΩøÁî®#import &lt; &gt; ÊâßË°åÂÆâË£ÖÔºèÊõ¥Êñ∞123pod installpod update CocoaPods ÂÆûÁé∞Âø´ÈÄüÊõ¥Êñ∞‰∏çÊ£ÄÊü•CocoaPods specsÊõ¥Êñ∞ 12pod install --verbose --no-repo-updatepod update --verbose --no-repo-update ÂçáÁ∫ßCocoaPods12345671.Ê∑ªÂä†ÈïúÂÉè$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/$ gem sources -l2.ÂçáÁ∫ß gemÊü•Áúãgem gem --versionsudo gem update --system 1-2Ëøô‰∏™ÂíåÂÆâË£ÖÊµÅÁ®ãÂ∑Æ‰∏çÂ§öÔºå‰∏çÂÜçÈáçÂ§ç 123.ÂçáÁ∫ßcocopodsudo gem install -n /usr/local/bin cocoapods --pre 1234.ËÆæÁΩÆpod ‰ªìÂ∫ìpod setup 125.Êü•ÁúãÁâàÊú¨pod --version CocoaPods ‰ΩøÁî®‰∏≠ÁöÑ‰∏Ä‰∫õÈóÆÈ¢òCocoaPods ÊêúÁ¥¢‰∏çÂà∞ÊúÄÊñ∞ÁöÑÁâàÊú¨Â∫ì1231.cocoapodsÁöÑÁâàÊú¨Ëøá‰Ωé2.ËøòÊ≤°ÊúâÊõ¥Êñ∞Êú¨Âú∞‰ªìÂ∫ì ÊåâÁÖß‰∏äËø∞Êõ¥Êñ∞cocoapodsÂç≥ÂèØ! github‰∏äÈ°πÁõÆ‰∏ãËΩΩÊâìÂºÄÂá∫Èîô123diff: /../Podfile.lock: No such file or directory diff: Manifest.lock: No such file or directory error: The sandbox is not in sync with the Podfile.lock. Run &apos;pod install&apos; or update your CocoaPods installation.` 1.ÂÖ≥Èó≠ÂΩìÂâçÁöÑÂ∑•‰ΩúÁ©∫Èó¥ÔºåÂà†Èô§ÊéâÊñá‰ª∂Â§π‰∏≠ÁöÑworkspace2.ÁÑ∂ÂêéÈáçÊñ∞pod install„ÄÇ3.installÂÆåÊàê‰πãÂêéÔºåÈÄöËøáworkspaceÊâìÂºÄÂ∑•‰ΩúÁ©∫Èó¥Ôºåclean+buildÂç≥ÂèØÔºö 12rm -rf MyProject.xcworkspace pod install Â§ö‰∏™xcodeÂá∫Áé∞ÈóÆÈ¢ò1sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer ÈÇ£‰πà‰Ω†ÁöÑÂëΩ‰ª§Ë°åÂ∞±Ë¶Å‰øÆÊîπ‰∏Ä‰∏ãÔºö 1sudo xcode-select -switch /Applications/Xcode 7.3.1.app/Contents/Developer Ê†πÊçÆ‰Ω†ÈªòËÆ§ÁöÑxcodeÊù•‰øÆÊîπÂú®/Applications/Âíå/Contents/Developer‰∏≠Èó¥ÁöÑappÁöÑÂêçÂ≠óÔºåÂ¶ÇÊûú‰Ω†ÈªòËÆ§ÁöÑÊòØXcode x.x.x.appÔºå‰∏≠Èó¥Â∞±Ë¶ÅÊõøÊç¢ÊéâÂìüÔºÅ]]></content>
      <tags>
        <tag>Â∑•ÂÖ∑Êé®Ëçê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MarkDownÁöÑÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2017%2F10%2F12%2FMarkDown%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ÂâçÂá†Â§©Êê≠Âª∫Â•Ω‰∫Ü‰∏™‰∫∫ÁΩëÁ´ôÔºå‰π∞‰∫ÜÂüüÂêçÔºåÊäòËÖæ‰∫ÜÂ•ΩÂá†‰∏™Êôö‰∏äÔºåÁªà‰∫éÂæÄ‰∫ã‰ø±Â§áÔºåÂè™Ê¨†‰∏úÈ£é‰∫Ü„ÄÇ‰º∞Êë∏ÁùÄÁ¨¨‰∏ÄÁØáÂÜô‰∫õÂï•ÔºåÊó¢ÁÑ∂ÈúÄË¶ÅMarkdownÊù•ÁºñÂÜôÔºåÈÇ£Â∞±‰ªémarkdownÂºÄÂàÄÂêß! ÂÜôÂçöÂÆ¢ÂøÖÈ°ªË¶ÅÊúâ‰∏ÄÂÆöÁöÑËá™Âà∂ÂäõÔºåÊâçËÉΩÂùöÊåÅ‰∏ãÂéªÔºå‰∏äÁè≠Ê≤°Ê≥ïÂÜôÔºåÂè™ËÉΩ‰∏ãÁè≠ÊäΩÁÇπÊó∂Èó¥Âá∫Êù•ÊÄªÁªì‰∏Ä‰∏ãÔºåÁØáÂπÖÔºåÊï∞Èáè‰∏çÂÆöÔºåÁªèËøáÂ≤ÅÊúàÊ≤âÊ∑ÄÁöÑÂá∫Êù•ÁöÑÊâçÊòØÂ•ΩÂçöÂÆ¢„ÄÇ Â∑•Ê¨≤ÂñÑÂÖ∂‰∫ãÔºåÂøÖÂÖàÂà©ÂÖ∂Âô®ÔºÅ Êàë‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑ÊòØ:Atom ‰∏ãÈù¢ËøõÂÖ•Ê≠£È¢òÔºö Ê†áÈ¢ò123456#‰∏ÄÁ∫ßÊ†áÈ¢ò##‰∫åÁ∫ßÊ†áÈ¢ò###‰∏âÁ∫ßÊ†áÈ¢ò####ÂõõÁ∫ßÊ†áÈ¢ò#####‰∫îÂèäÊ†áÈ¢ò Â±ïÁ§∫ÊïàÊûúÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Â≠ó‰Ωì123456**Á≤ó‰Ωì***Êñú‰Ωì****Êñú‰Ωì+Á≤ó‰Ωì*** ÊïàÊûúÂ¶Ç‰∏ã: ÂàÜÂâ≤Á∫ø‰Ω†ÂèØ‰ª•Âú®‰∏ÄË°å‰∏≠Áî®‰∏â‰∏™‰ª•‰∏äÁöÑÊòüÂè∑„ÄÅÂáèÂè∑„ÄÅÂ∫ïÁ∫øÊù•Âª∫Á´ã‰∏Ä‰∏™ÂàÜÈöîÁ∫øÔºåË°åÂÜÖ‰∏çËÉΩÊúâÂÖ∂‰ªñ‰∏úË•ø„ÄÇ‰Ω†‰πüÂèØ‰ª•Âú®ÊòüÂè∑ÊàñÊòØÂáèÂè∑‰∏≠Èó¥ÊèíÂÖ•Á©∫Ê†º„ÄÇ‰∏ãÈù¢ÊØèÁßçÂÜôÊ≥ïÈÉΩÂèØ‰ª•Âª∫Á´ãÂàÜÈöîÁ∫øÔºö 123456789101112* * *********- - -‰∏ñÁïå‰Ω†Â•Ω---------------------------------------* ‰∏ñÁïå‰Ω†Â•Ω ÂèçÊñúÊù†ÂèØ‰ª•Âà©Áî®ÂèçÊñúÊù†Êù•ÊèíÂÖ•‰∏Ä‰∫õÂú®ËØ≠Ê≥ï‰∏≠ÊúâÂÖ∂ÂÆÉÊÑè‰πâÁöÑÁ¨¶Âè∑Ôºå‰æãÂ¶ÇÔºöÂ¶ÇÊûú‰Ω†ÊÉ≥Ë¶ÅÁî®ÊòüÂè∑Âä†Âú®ÊñáÂ≠óÊóÅËæπÁöÑÊñπÂºèÊù•ÂÅöÂá∫Âº∫Ë∞ÉÊïàÊûúÔºà‰ΩÜ‰∏çÁî® Ê†áÁ≠æÔºâÔºå‰Ω†ÂèØ‰ª•Âú®ÊòüÂè∑ÁöÑÂâçÈù¢Âä†‰∏äÂèçÊñúÊù†Ôºö 12\*literal asterisks\* *literal asterisks* ÂõæÁâá‰∏éÈìæÊé•ÂõæÁâá123![ÂëΩÂêç](ÂõæÁâáÈìæÊé•)ÊØîÂ¶Ç:![Â≠ó‰Ωì](http://oxv4ynhvc.bkt.clouddn.com/MKFont.png) ÈìæÊé•123[ÈìæÊé•ÊòæÁ§∫ÊñáÂ≠ó](ÈìæÊé•Âú∞ÂùÄ)ÊØîÂ¶Ç:[ÂçöÂÆ¢](http://taodongbo.cn) ÂçöÂÆ¢Âú∞ÂùÄ: ÂçöÂÆ¢ ÂàóË°®Êó†Â∫è12345* **Âä†Á≤ó**‰∏æ‰∏™‰æãÂ≠ê* Ë¢´ÊòüÊòüÂåÖÂõ¥ÁöÑÂä†ÈÜã**Âä†Á≤ó**- **ÂáèÂè∑**‰∏ÄÊ†∑ÁöÑÊïàÊûú+ **Âä†Âè∑**‰∏ÄÊ†∑ÁöÑÊïàÊûú ÊïàÊûúÂ¶Ç‰∏ã ÊúâÂ∫è1234561.ÊñáÊú¨2.Ê†áÈ¢ò3.ÂõæÁâá ÂºïÁî®12&gt; Âô´ÂêÅÂö±ÔºåÂç±‰πéÈ´òÂìâÔºÅËúÄÈÅì‰πãÈöæÔºåÈöæ‰∫é‰∏äÈùíÂ§©ÔºÅËöï‰∏õÂèäÈ±ºÂá´ÔºåÂºÄÂõΩ‰ΩïËå´ÁÑ∂ÔºÅÂ∞îÊù•Âõõ‰∏áÂÖ´ÂçÉÂ≤ÅÔºå‰∏ç‰∏éÁß¶Â°ûÈÄö‰∫∫ÁÉü„ÄÇË•øÂΩìÂ§™ÁôΩÊúâÈ∏üÈÅìÔºåÂèØ‰ª•Ê®™ÁªùÂ≥®ÁúâÂ∑Ö„ÄÇÂú∞Â¥©Â±±ÊëßÂ£ÆÂ£´Ê≠ªÔºåÁÑ∂ÂêéÂ§©Ê¢ØÁü≥Ê†àÁõ∏Èí©Ëøû„ÄÇ‰∏äÊúâÂÖ≠ÈæôÂõûÊó•‰πãÈ´òÊ†áÔºå‰∏ãÊúâÂÜ≤Ê≥¢ÈÄÜÊäò‰πã ÊïàÊûúÂ¶Ç‰∏ã: ‰ª£Á†ÅÂºïÁî®‰∏ÄÂè•‰ª£Á†Å‰∏éÂ§öÂè•ÁöÑÂå∫Âà´Âú®‰∫é ` ËøòÊòØ 3‰∏™` ‰∏ÄÂè•‰ª£Á†Å12`[self.view addSubView:label]` ‰∏ÄÊÆµ‰ª£Á†Å Â±ïÁ§∫ÊïàÊûúÂàÜÂà´Â¶Ç‰∏ã: Ë°®Ê†º123456|ÈªòËÆ§|Â±Ö‰∏≠|Â∑¶ÂØπÈΩê|Âè≥ÂØπÈΩê||--|:-:|:-|-:||ÊµãËØïÊç¢Ë°å\n‰∏çÊîØÊåÅÊç¢Ë°å|ÊµãËØï1|ÊµãËØï2|ÊµãËØï3||*Êñú‰Ωì*|**Á≤ó‰Ωì**|***Êñú‰Ωì+Á≤ó‰Ωì***|Ê≠£Â∏∏||# ‰∏çÂèØÊîæÊ†áÈ¢ò|[ÂèØÊîæÈìæÊé•](taodongbo.cn)|![ÂèØÊîæÂõæÁâá](http://oxv4ynhvc.bkt.clouddn.com/MKYY.png)|`ÂèØÊîæ‰ª£Á†Å hello word ` ‰ª•‰∏äÊòØ‰∏Ä‰∫õÂü∫Êú¨ÁöÑÁî®Ê≥ïÔºåÊõ¥Â§öÂèÇËÄÉËØ≠Ê≥ïËØ¥Êòé]]></content>
      <categories>
        <category>Â∑•ÂÖ∑Êé®Ëçê</category>
      </categories>
      <tags>
        <tag>Â∑•ÂÖ∑</tag>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GCDËØ¶Ëß£]]></title>
    <url>%2F2017%2F04%2F21%2FGCD%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[GCDÔºàGrand Central DispatchÔºâ ‰ªãÁªçGCDÂ±û‰∫éÁ≥ªÁªüÁ∫ßÁöÑÁ∫øÁ®ãÁÆ°ÁêÜÔºåÂú®Dispatch queue‰∏≠ÊâßË°åÈúÄË¶ÅÊâßË°åÁöÑ‰ªªÂä°ÊÄßËÉΩÈùûÂ∏∏ÁöÑÈ´ò„ÄÇGCDËøôÂùóÂ∑≤ÁªèÂºÄÊ∫êÔºåÂú∞ÂùÄhttp://libdispatch.macosforge.org„ÄÇGCD‰∏≠ÁöÑFIFOÈòüÂàóÁß∞‰∏∫dispatch queueÔºåÁî®Êù•‰øùËØÅÂÖàËøõÊù•ÁöÑ‰ªªÂä°ÂÖàÂæóÂà∞ÊâßË°å„ÄÇ GCDÊ¶ÇË¶Å Âíåoperation queue‰∏ÄÊ†∑ÈÉΩÊòØÂü∫‰∫éÈòüÂàóÁöÑÂπ∂ÂèëÁºñÁ®ãAPIÔºå‰ªñ‰ª¨ÈÄöËøáÈõÜ‰∏≠ÁÆ°ÁêÜÂ§ßÂÆ∂ÂçèÂêå‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊ±†„ÄÇ ÂÖ¨ÂºÄÁöÑ5‰∏™‰∏çÂêåÈòüÂàóÔºöËøêË°åÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÁöÑmain queueÔºå3‰∏™‰∏çÂêå‰ºòÂÖàÁ∫ßÁöÑÂêéÂè∞ÈòüÂàóÔºàHigh Priority QueueÔºåDefault Priority QueueÔºåLow Priority QueueÔºâÔºå‰ª•Âèä‰∏Ä‰∏™‰ºòÂÖàÁ∫ßÊõ¥‰ΩéÁöÑÂêéÂè∞ÈòüÂàóBackground Priority QueueÔºàÁî®‰∫éI/OÔºâ ÂèØÂàõÂª∫Ëá™ÂÆö‰πâÈòüÂàóÔºö‰∏≤Ë°åÊàñÂπ∂ÂàóÈòüÂàó„ÄÇËá™ÂÆö‰πâ‰∏ÄËà¨ÊîæÂú®Default Priority QueueÂíåMain QueueÈáå„ÄÇ Êìç‰ΩúÊòØÂú®Â§öÁ∫øÁ®ã‰∏äËøòÊòØÂçïÁ∫øÁ®ã‰∏ªË¶ÅÊòØÁúãÈòüÂàóÁöÑÁ±ªÂûãÂíåÊâßË°åÊñπÊ≥ïÔºåÂπ∂Ë°åÈòüÂàóÂºÇÊ≠•ÊâßË°åÊâçËÉΩÂú®Â§öÁ∫øÁ®ãÔºåÂπ∂Ë°åÈòüÂàóÂêåÊ≠•ÊâßË°åÂ∞±Âè™‰ºöÂú®Ëøô‰∏™Âπ∂Ë°åÈòüÂàóÂú®ÈòüÂàó‰∏≠Ë¢´ÂàÜÈÖçÁöÑÈÇ£‰∏™Á∫øÁ®ãÊâßË°å„ÄÇ Âü∫Êú¨Ê¶ÇÂøµ Á≥ªÁªüÊ†áÂáÜ‰∏§‰∏™ÈòüÂàó 1234//ÂÖ®Â±ÄÈòüÂàóÔºå‰∏Ä‰∏™Âπ∂Ë°åÁöÑÈòüÂàódispatch_get_global_queue//‰∏ªÈòüÂàóÔºå‰∏ªÁ∫øÁ®ã‰∏≠ÁöÑÂîØ‰∏ÄÈòüÂàóÔºå‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàódispatch_get_main_queue Ëá™ÂÆö‰πâÈòüÂàó 1234//‰∏≤Ë°åÈòüÂàódispatch_queue_create(&quot;com.starming.serialqueue&quot;, DISPATCH_QUEUE_SERIAL)//Âπ∂Ë°åÈòüÂàódispatch_queue_create(&quot;com.starming.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT) ÂêåÊ≠•ÂºÇÊ≠•Á∫øÁ®ãÂàõÂª∫ 1234//ÂêåÊ≠•Á∫øÁ®ãdispatch_sync(..., ^(block))//ÂºÇÊ≠•Á∫øÁ®ãdispatch_async(..., ^(block)) ÈòüÂàóÔºàdispatch queueÔºâ SerialÔºöÂèàÂè´private dispatch queuesÔºåÂêåÊó∂Âè™ÊâßË°å‰∏Ä‰∏™‰ªªÂä°„ÄÇSerial queueÂ∏∏Áî®‰∫éÂêåÊ≠•ËÆøÈóÆÁâπÂÆöÁöÑËµÑÊ∫êÊàñÊï∞ÊçÆ„ÄÇÂΩì‰Ω†ÂàõÂª∫Â§ö‰∏™Serial queueÊó∂ÔºåËôΩÁÑ∂ÂêÑËá™ÊòØÂêåÊ≠•Ôºå‰ΩÜserial queue‰πãÈó¥ÊòØÂπ∂ÂèëÊâßË°å„ÄÇ Main dispatch queueÔºöÂÖ®Â±ÄÂèØÁî®ÁöÑserial queueÔºåÂú®Â∫îÁî®Á®ãÂ∫è‰∏ªÁ∫øÁ®ã‰∏äÊâßË°å‰ªªÂä°„ÄÇ ConcurrentÔºöÂèàÂè´global dispatch queueÔºåÂèØ‰ª•Âπ∂ÂèëÁöÑÊâßË°åÂ§ö‰∏™‰ªªÂä°Ôºå‰ΩÜÊâßË°åÂÆåÊàêÈ°∫Â∫èÊòØÈöèÊú∫ÁöÑ„ÄÇÁ≥ªÁªüÊèê‰æõÂõõ‰∏™ÂÖ®Â±ÄÂπ∂ÂèëÈòüÂàóÔºåËøôÂõõ‰∏™ÈòüÂàóÊúâËøôÂØπÂ∫îÁöÑ‰ºòÂÖàÁ∫ßÔºåÁî®Êà∑ÊòØ‰∏çËÉΩÂ§üÂàõÂª∫ÂÖ®Â±ÄÈòüÂàóÁöÑÔºåÂè™ËÉΩËé∑Âèñ„ÄÇ 12dipatch_queue_t queue;queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,0); user create queueÔºöÂàõÂª∫Ëá™Â∑±ÂÆö‰πâÁöÑÈòüÂàóÔºåÂèØ‰ª•Áî®dispatch_queue_createÂáΩÊï∞ÔºåÂáΩÊï∞Êúâ‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÈòüÂàóÂêçÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÈòüÂàóÁ±ªÂûãÔºåÈªòËÆ§NULLÊàñËÄÖDISPATCH_QUEUE_SERIALÁöÑÊòØ‰∏≤Ë°åÔºåÂèÇÊï∞‰∏∫DISPATCH_QUEUE_CONCURRENT‰∏∫Âπ∂Ë°åÈòüÂàó„ÄÇ 12dispatch_queue_t queuequeue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT); Ëá™ÂÆö‰πâÈòüÂàóÁöÑ‰ºòÂÖàÁ∫ßÔºöÂèØ‰ª•ÈÄöËøádipatch_queue_attr_make_with_qos_classÊàñdispatch_set_target_queueÊñπÊ≥ïËÆæÁΩÆÈòüÂàóÁöÑ‰ºòÂÖàÁ∫ß 12345678//dipatch_queue_attr_make_with_qos_classdispatch_queue_attr_t attr = dispatch_queue_attr_make_with_qos_class(DISPATCH_QUEUE_SERIAL, QOS_CLASS_UTILITY, -1);dispatch_queue_t queue = dispatch_queue_create(&quot;com.starming.gcddemo.qosqueue&quot;, attr);//dispatch_set_target_queuedispatch_queue_t queue = dispatch_queue_create(&quot;com.starming.gcddemo.settargetqueue&quot;,NULL); //ÈúÄË¶ÅËÆæÁΩÆ‰ºòÂÖàÁ∫ßÁöÑqueuedispatch_queue_t referQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0); //ÂèÇËÄÉ‰ºòÂÖàÁ∫ßdispatch_set_target_queue(queue, referQueue); //ËÆæÁΩÆqueueÂíåreferQueueÁöÑ‰ºòÂÖàÁ∫ß‰∏ÄÊ†∑ dispatch_set_target_queueÔºöÂèØ‰ª•ËÆæÁΩÆ‰ºòÂÖàÁ∫ßÔºå‰πüÂèØ‰ª•ËÆæÁΩÆÈòüÂàóÂ±ÇÁ∫ß‰ΩìÁ≥ªÔºåÊØîÂ¶ÇËÆ©Â§ö‰∏™‰∏≤Ë°åÂíåÂπ∂Ë°åÈòüÂàóÂú®Áªü‰∏Ä‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÈáå‰∏≤Ë°åÊâßË°åÔºåÂ¶Ç‰∏ã 12345678910111213141516171819dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL);dispatch_queue_t firstQueue = dispatch_queue_create(&quot;com.starming.gcddemo.firstqueue&quot;, DISPATCH_QUEUE_SERIAL);dispatch_queue_t secondQueue = dispatch_queue_create(&quot;com.starming.gcddemo.secondqueue&quot;, DISPATCH_QUEUE_CONCURRENT);dispatch_set_target_queue(firstQueue, serialQueue);dispatch_set_target_queue(secondQueue, serialQueue);dispatch_async(firstQueue, ^&#123; NSLog(@&quot;1&quot;); [NSThread sleepForTimeInterval:3.f];&#125;);dispatch_async(secondQueue, ^&#123; NSLog(@&quot;2&quot;); [NSThread sleepForTimeInterval:2.f];&#125;);dispatch_async(secondQueue, ^&#123; NSLog(@&quot;3&quot;); [NSThread sleepForTimeInterval:1.f];&#125;); ÈòüÂàóÁ±ªÂûãÈòüÂàóÈªòËÆ§ÊòØ‰∏≤Ë°åÁöÑÔºåÂ¶ÇÊûúËÆæÁΩÆÊîπÂèÇÊï∞‰∏∫NULL‰ºöÊåâ‰∏≤Ë°åÂ§ÑÁêÜÔºåÂè™ËÉΩÊâßË°å‰∏Ä‰∏™ÂçïÁã¨ÁöÑblockÔºåÈòüÂàó‰πüÂèØ‰ª•ÊòØÂπ∂Ë°åÁöÑÔºåÂêå‰∏ÄÊó∂Èó¥ÊâßË°åÂ§ö‰∏™block 123456789101112- (id)init;&#123; self = [super init]; if (self != nil) &#123; NSString *label = [NSString stringWithFormat:@&quot;%@.isolation.%p&quot;, [self class], self]; self.isolationQueue = dispatch_queue_create([label UTF8String], 0); label = [NSString stringWithFormat:@&quot;%@.work.%p&quot;, [self class], self]; self.workQueue = dispatch_queue_create([label UTF8String], 0); &#125; return self;&#125; 5ÁßçÈòüÂàóÔºå‰∏ªÈòüÂàóÔºàmain queueÔºâ,ÂõõÁßçÈÄöÁî®Ë∞ÉÂ∫¶ÈòüÂàóÔºåËá™Â∑±ÂÆöÂà∂ÁöÑÈòüÂàó„ÄÇÂõõÁßçÈÄöÁî®Ë∞ÉÂ∫¶ÈòüÂàó‰∏∫ QOS_CLASS_USER_INTERACTIVEÔºöuser interactiveÁ≠âÁ∫ßË°®Á§∫‰ªªÂä°ÈúÄË¶ÅË¢´Á´ãÂç≥ÊâßË°åÊèê‰æõÂ•ΩÁöÑ‰ΩìÈ™åÔºåÁî®Êù•Êõ¥Êñ∞UIÔºåÂìçÂ∫î‰∫ã‰ª∂Á≠â„ÄÇËøô‰∏™Á≠âÁ∫ßÊúÄÂ•Ω‰øùÊåÅÂ∞èËßÑÊ®°„ÄÇ QOS_CLASS_USER_INITIATEDÔºöuser initiatedÁ≠âÁ∫ßË°®Á§∫‰ªªÂä°Áî±UIÂèëËµ∑ÂºÇÊ≠•ÊâßË°å„ÄÇÈÄÇÁî®Âú∫ÊôØÊòØÈúÄË¶ÅÂèäÊó∂ÁªìÊûúÂêåÊó∂ÂèàÂèØ‰ª•ÁªßÁª≠‰∫§‰∫íÁöÑÊó∂ÂÄô„ÄÇ QOS_CLASS_UTILITYÔºöutilityÁ≠âÁ∫ßË°®Á§∫ÈúÄË¶ÅÈïøÊó∂Èó¥ËøêË°åÁöÑ‰ªªÂä°Ôºå‰º¥ÊúâÁî®Êà∑ÂèØËßÅËøõÂ∫¶ÊåáÁ§∫Âô®„ÄÇÁªèÂ∏∏‰ºöÁî®Êù•ÂÅöËÆ°ÁÆóÔºåI/OÔºåÁΩëÁªúÔºåÊåÅÁª≠ÁöÑÊï∞ÊçÆÂ°´ÂÖÖÁ≠â‰ªªÂä°„ÄÇËøô‰∏™‰ªªÂä°ËäÇËÉΩ„ÄÇ QOS_CLASS_BACKGROUNDÔºöbackgroundÁ≠âÁ∫ßË°®Á§∫Áî®Êà∑‰∏ç‰ºöÂØüËßâÁöÑ‰ªªÂä°Ôºå‰ΩøÁî®ÂÆÉÊù•Â§ÑÁêÜÈ¢ÑÂä†ËΩΩÔºåÊàñËÄÖ‰∏çÈúÄË¶ÅÁî®Êà∑‰∫§‰∫íÂíåÂØπÊó∂Èó¥‰∏çÊïèÊÑüÁöÑ‰ªªÂä°„ÄÇÁ§∫‰æãÔºöÂêéÂè∞Âä†ËΩΩÊòæÁ§∫ÂõæÁâá12345678910override func viewDidLoad() &#123; super.viewDidLoad() dispatch_async(dispatch_get_global_queue(Int(QOS_CLASS_USER_INITIATED.value), 0)) &#123; // Â∞ÜÂ∑•‰Ωú‰ªé‰∏ªÁ∫øÁ®ãËΩ¨ÁßªÂà∞ÂÖ®Â±ÄÈòüÂàó‰∏≠ÔºåËøôÊòØdispatch_asyncË∞ÉÁî®ÔºåÂºÇÊ≠•Êèê‰∫§‰øùËØÅË∞ÉÁî®Á∫øÁ®ã‰ºöÁªßÁª≠ÊâßË°å‰∏ãÂéªÔºåËøôÊ†∑viewDidLoadÂú®‰∏ªÁ∫øÁ®ã‰∏äËÉΩÂ§üÊõ¥Êó©ÂÆåÊàêÔºå let overlayImage = self.faceOverlayImageFromImage(self.image) dispatch_async(dispatch_get_main_queue()) &#123; // Êñ∞ÂõæÂÆåÊàêÔºåÊää‰∏Ä‰∏™Èó≠ÂåÖÂä†ÂÖ•‰∏ªÁ∫øÁ®ãÁî®Êù•Êõ¥Êñ∞UIImageViewÔºåÂè™ÊúâÂú®‰∏ªÁ∫øÁ®ãËÉΩÊìç‰ΩúUIKit„ÄÇ self.fadeInNewImage(overlayImage) // Êõ¥Êñ∞UI &#125; &#125;&#125; ‰ΩïÊó∂‰ΩøÁî®‰ΩïÁßçÈòüÂàóÁ±ªÂûã ‰∏ªÈòüÂàóÔºàÈ°∫Â∫èÔºâÔºöÈòüÂàó‰∏≠Êúâ‰ªªÂä°ÂÆåÊàêÈúÄË¶ÅÊõ¥Êñ∞UIÊó∂Ôºådispatch_afterÂú®ËøôÁßçÁ±ªÂûã‰∏≠‰ΩøÁî®„ÄÇ Âπ∂ÂèëÈòüÂàóÔºöÁî®Êù•ÊâßË°å‰∏éUIÊó†ÂÖ≥ÁöÑÂêéÂè∞‰ªªÂä°Ôºådispatch_syncÊîæÂú®ËøôÈáåÔºåÊñπ‰æøÁ≠âÂæÖ‰ªªÂä°ÂÆåÊàêËøõË°åÂêéÁª≠Â§ÑÁêÜÊàñÂíådispatch barrierÂêåÊ≠•„ÄÇdispatch groupsÊîæÂú®ËøôÈáå‰πü‰∏çÈîô„ÄÇ Ëá™ÂÆö‰πâÈ°∫Â∫èÈòüÂàóÔºöÈ°∫Â∫èÊâßË°åÂêéÂè∞‰ªªÂä°Âπ∂ËøΩË∏™ÂÆÉÊó∂„ÄÇËøôÊ†∑ÂÅöÂêåÊó∂Âè™Êúâ‰∏Ä‰∏™‰ªªÂä°Âú®ÊâßË°åÂèØ‰ª•Èò≤Ê≠¢ËµÑÊ∫êÁ´û‰∫â„ÄÇdipatch barriersËß£ÂÜ≥ËØªÂÜôÈîÅÈóÆÈ¢òÁöÑÊîæÂú®ËøôÈáåÂ§ÑÁêÜ„ÄÇdispatch groups‰πüÊòØÊîæÂú®ËøôÈáå„ÄÇÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑÊñπÊ≥ïÁÆÄÂåñQoSÁ≠âÁ∫ßÂèÇÊï∞ÁöÑÂÜôÊ≥ï 1234567891011121314151617181920212223var GlobalMainQueue: dispatch_queue_t &#123; return dispatch_get_main_queue()&#125;var GlobalUserInteractiveQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_USER_INTERACTIVE.value), 0)&#125;var GlobalUserInitiatedQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_USER_INITIATED.value), 0)&#125;var GlobalUtilityQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_UTILITY.value), 0)&#125;var GlobalBackgroundQueue: dispatch_queue_t &#123; return dispatch_get_global_queue(Int(QOS_CLASS_BACKGROUND.value), 0)&#125;//‰ΩøÁî®Ëµ∑Êù•Â∞±ÊòØËøôÊ†∑ÔºåÊòìËØªËÄå‰∏îÂÆπÊòìÁúãÂá∫Âú®‰ΩøÁî®Âì™‰∏™ÈòüÂàódispatch_async(GlobalUserInitiatedQueue) &#123; let overlayImage = self.faceOverlayImageFromImage(self.image) dispatch_async(GlobalMainQueue) &#123; self.fadeInNewImage(overlayImage) &#125;&#125; dispatch_onceÁî®Ê≥ïdispatch_once_tË¶ÅÊòØÂÖ®Â±ÄÊàñstaticÂèòÈáèÔºå‰øùËØÅdispatch_once_tÂè™Êúâ‰∏Ä‰ªΩÂÆû‰æã1234567891011+ (UIColor *)boringColor;&#123; static UIColor *color; //Âè™ËøêË°å‰∏ÄÊ¨° static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; color = [UIColor colorWithRed:0.380f green:0.376f blue:0.376f alpha:1.000f]; &#125;); return color;&#125;dispatch_async ËÆæËÆ°‰∏Ä‰∏™ÂºÇÊ≠•ÁöÑAPIË∞ÉÁî®dispatch_async()ÔºåËøô‰∏™Ë∞ÉÁî®ÊîæÂú®APIÁöÑÊñπÊ≥ïÊàñÂáΩÊï∞‰∏≠ÂÅö„ÄÇËÆ©APIÁöÑ‰ΩøÁî®ËÄÖËÆæÁΩÆ‰∏Ä‰∏™ÂõûË∞ÉÂ§ÑÁêÜÈòüÂàó 123456789- (void)processImage:(UIImage *)image completionHandler:(void(^)(BOOL success))handler;&#123; dispatch_async(self.isolationQueue, ^(void)&#123; // do actual processing here dispatch_async(self.resultQueue, ^(void)&#123; handler(YES); &#125;); &#125;);&#125; ÂèØ‰ª•ÈÅøÂÖçÁïåÈù¢‰ºöË¢´‰∏Ä‰∫õËÄóÊó∂ÁöÑÊìç‰ΩúÂç°Ê≠ªÔºåÊØîÂ¶ÇËØªÂèñÁΩëÁªúÊï∞ÊçÆÔºåÂ§ßÊï∞ÊçÆIOÔºåËøòÊúâÂ§ßÈáèÊï∞ÊçÆÁöÑÊï∞ÊçÆÂ∫ìËØªÂÜôÔºåËøôÊó∂ÈúÄË¶ÅÂú®Âè¶‰∏Ä‰∏™Á∫øÁ®ã‰∏≠Â§ÑÁêÜÔºåÁÑ∂ÂêéÈÄöÁü•‰∏ªÁ∫øÁ®ãÊõ¥Êñ∞ÁïåÈù¢ÔºåGCD‰ΩøÁî®Ëµ∑Êù•ÊØîNSThreadÂíåNSOperationÊñπÊ≥ïË¶ÅÁÆÄÂçïÊñπ‰æø„ÄÇ12345678910111213141516171819//‰ª£Á†ÅÊ°ÜÊû∂dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; // ËÄóÊó∂ÁöÑÊìç‰Ωú dispatch_async(dispatch_get_main_queue(), ^&#123; // Êõ¥Êñ∞ÁïåÈù¢ &#125;);&#125;);//‰∏ãËΩΩÂõæÁâáÁöÑÁ§∫‰æãdispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSURL * url = [NSURL URLWithString:@&quot;http://avatar.csdn.net/2/C/D/1_totogo2010.jpg&quot;]; NSData * data = [[NSData alloc]initWithContentsOfURL:url]; UIImage *image = [[UIImage alloc]initWithData:data]; if (data != nil) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; self.imageView.image = image; &#125;); &#125;&#125;); dispatch_afterÂª∂ÂêéÊâßË°ådispatch_afterÂè™ÊòØÂª∂Êó∂Êèê‰∫§blockÔºå‰∏çÊòØÂª∂Êó∂Á´ãÂàªÊâßË°å„ÄÇ12345678- (void)foo&#123; double delayInSeconds = 2.0; dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t) (delayInSeconds * NSEC_PER_SEC)); dispatch_after(popTime, dispatch_get_main_queue(), ^(void)&#123; [self bar]; &#125;);&#125; ËåÉ‰æãÔºåÂÆûÁé∞‰∏Ä‰∏™Êé®ËøüÂá∫Áé∞ÂºπÂá∫Ê°ÜÊèêÁ§∫ÔºåÊØîÂ¶ÇËØ¥ÊèêÁ§∫Áî®Êà∑ËØÑ‰ª∑Á≠âÂäüËÉΩ„ÄÇ12345678910111213func showOrHideNavPrompt() &#123; let delayInSeconds = 1.0 let popTime = dispatch_time(DISPATCH_TIME_NOW, Int64(delayInSeconds * Double(NSEC_PER_SEC))) // Âú®ËøôÈáåÂ£∞ÊòéÊé®ËøüÁöÑÊó∂Èó¥ dispatch_after(popTime, GlobalMainQueue) &#123; // Á≠âÂæÖdelayInSecondsÂ∞ÜÈó≠ÂåÖÂºÇÊ≠•Âà∞‰∏ªÈòüÂàó let count = PhotoManager.sharedManager.photos.count if count &gt; 0 &#123; self.navigationItem.prompt = nil &#125; else &#123; self.navigationItem.prompt = &quot;Add photos with faces to Googlyify them!&quot; &#125; &#125;&#125; ‰æãÂ≠ê‰∏≠ÁöÑdispatch timeÁöÑÂèÇÊï∞ÔºåÂèØ‰ª•ÂÖàÁúãÁúãÂáΩÊï∞ÂéüÂûã 1dispatch_time_t dispatch_time ( dispatch_time_t when, int64_t delta ); Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫DISPATCH_TIME_NOWË°®Á§∫ÂΩìÂâç„ÄÇÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÁöÑdeltaË°®Á§∫Á∫≥ÁßíÔºå‰∏ÄÁßíÂØπÂ∫îÁöÑÁ∫≥Áßí‰∏∫1000000000ÔºåÁ≥ªÁªüÊèê‰æõ‰∫Ü‰∏Ä‰∫õÂÆèÊù•ÁÆÄÂåñ 123#define NSEC_PER_SEC 1000000000ull //ÊØèÁßíÊúâÂ§öÂ∞ëÁ∫≥Áßí#define USEC_PER_SEC 1000000ull //ÊØèÁßíÊúâÂ§öÂ∞ëÊØ´Áßí#define NSEC_PER_USEC 1000ull //ÊØèÊØ´ÁßíÊúâÂ§öÂ∞ëÁ∫≥Áßí ËøôÊ†∑Â¶ÇÊûúË¶ÅË°®Á§∫‰∏ÄÁßíÂ∞±ÂèØ‰ª•ËøôÊ†∑ÂÜô123dispatch_time(DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC);dispatch_time(DISPATCH_TIME_NOW, 1000 * USEC_PER_SEC);dispatch_time(DISPATCH_TIME_NOW, USEC_PER_SEC * NSEC_PER_USEC); dispatch_barrier_async‰ΩøÁî®Barrier TaskÊñπÊ≥ïDispatch BarrierËß£ÂÜ≥Â§öÁ∫øÁ®ãÂπ∂ÂèëËØªÂÜôÂêå‰∏Ä‰∏™ËµÑÊ∫êÂèëÁîüÊ≠ªÈîÅDispatch BarrierÁ°Æ‰øùÊèê‰∫§ÁöÑÈó≠ÂåÖÊòØÊåáÂÆöÈòüÂàó‰∏≠Âú®ÁâπÂÆöÊó∂ÊÆµÂîØ‰∏ÄÂú®ÊâßË°åÁöÑ‰∏Ä‰∏™„ÄÇÂú®ÊâÄÊúâÂÖà‰∫éDispatch BarrierÁöÑ‰ªªÂä°ÈÉΩÂÆåÊàêÁöÑÊÉÖÂÜµ‰∏ãËøô‰∏™Èó≠ÂåÖÊâçÂºÄÂßãÊâßË°å„ÄÇËΩÆÂà∞Ëøô‰∏™Èó≠ÂåÖÊó∂barrier‰ºöÊâßË°åËøô‰∏™Èó≠ÂåÖÂπ∂‰∏îÁ°Æ‰øùÈòüÂàóÂú®Ê≠§ËøáÁ®ã‰∏ç‰ºöÊâßË°åÂÖ∂ÂÆÉ‰ªªÂä°„ÄÇÈó≠ÂåÖÂÆåÊàêÂêéÈòüÂàóÊÅ¢Â§ç„ÄÇÈúÄË¶ÅÊ≥®ÊÑèdispatch_barrier_asyncÂè™Âú®Ëá™Â∑±ÂàõÂª∫ÁöÑÈòüÂàó‰∏äÊúâËøôÁßç‰ΩúÁî®ÔºåÂú®ÂÖ®Â±ÄÂπ∂ÂèëÈòüÂàóÂíå‰∏≤Ë°åÈòüÂàó‰∏äÔºåÊïàÊûúÂíådispatch_sync‰∏ÄÊ†∑ 1234567891011121314151617181920212223242526272829303132333435363738//ÂàõÂª∫ÈòüÂàóself.isolationQueue = dispatch_queue_create([label UTF8String], DISPATCH_QUEUE_CONCURRENT);//ÊîπÂèòsetter- (void)setCount:(NSUInteger)count forKey:(NSString *)key&#123; key = [key copy]; //Á°Æ‰øùÊâÄÊúâbarrierÈÉΩÊòØasyncÂºÇÊ≠•ÁöÑ dispatch_barrier_async(self.isolationQueue, ^()&#123; if (count == 0) &#123; [self.counts removeObjectForKey:key]; &#125; else &#123; self.counts[key] = @(count); &#125; &#125;);&#125;- (void)dispatchBarrierAsyncDemo &#123; //Èò≤Ê≠¢Êñá‰ª∂ËØªÂÜôÂÜ≤Á™ÅÔºåÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÔºåÊìç‰ΩúÈÉΩÂú®Ëøô‰∏™ÈòüÂàó‰∏≠ËøõË°åÔºåÊ≤°ÊúâÊõ¥Êñ∞Êï∞ÊçÆËØªÁî®Âπ∂Ë°åÔºåÂÜôÁî®‰∏≤Ë°å„ÄÇ dispatch_queue_t dataQueue = dispatch_queue_create(&quot;com.starming.gcddemo.dataqueue&quot;, DISPATCH_QUEUE_CONCURRENT); dispatch_async(dataQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;read data 1&quot;); &#125;); dispatch_async(dataQueue, ^&#123; NSLog(@&quot;read data 2&quot;); &#125;); //Á≠âÂæÖÂâçÈù¢ÁöÑÈÉΩÂÆåÊàêÔºåÂú®ÊâßË°åbarrierÂêéÈù¢ÁöÑ dispatch_barrier_async(dataQueue, ^&#123; NSLog(@&quot;write data 1&quot;); [NSThread sleepForTimeInterval:1]; &#125;); dispatch_async(dataQueue, ^&#123; [NSThread sleepForTimeInterval:1.f]; NSLog(@&quot;read data 3&quot;); &#125;); dispatch_async(dataQueue, ^&#123; NSLog(@&quot;read data 4&quot;); &#125;);&#125; swiftÁ§∫‰æã12345678910111213141516171819202122//‰ΩøÁî®dispatch_queue_createÂàùÂßãÂåñ‰∏Ä‰∏™Âπ∂ÂèëÈòüÂàó„ÄÇÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÈÅµÂæ™ÂèçÂêëDNSÂëΩÂêç‰π†ÊÉØÔºåÊñπ‰æøÊèèËø∞ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÊåáÂá∫ÊòØÂπ∂ÂèëËøòÊòØÈ°∫Â∫è„ÄÇprivate let concurrentPhotoQueue = dispatch_queue_create(&quot;com.raywenderlich.GooglyPuff.photoQueue&quot;, DISPATCH_QUEUE_CONCURRENT)func addPhoto(photo: Photo) &#123; dispatch_barrier_async(concurrentPhotoQueue) &#123; // Â∞ÜÂÜôÊìç‰ΩúÂä†ÂÖ•Âà∞Ëá™ÂÆö‰πâÁöÑÈòüÂàó„ÄÇÂºÄÂßãÊâßË°åÊó∂Ëøô‰∏™Â∞±ÊòØÈòüÂàó‰∏≠ÂîØ‰∏ÄÁöÑ‰∏Ä‰∏™Âú®ÊâßË°åÁöÑ‰ªªÂä°„ÄÇ self._photos.append(photo) // barrierËÉΩÂ§ü‰øùÈöú‰∏ç‰ºöÂíåÂÖ∂‰ªñ‰ªªÂä°ÂêåÊó∂ËøõË°å„ÄÇ dispatch_async(GlobalMainQueue) &#123; // Ê∂âÂèäÂà∞UIÊâÄ‰ª•Ëøô‰∏™ÈÄöÁü•Â∫îËØ•Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÔºåÊâÄ‰ª•ÂàÜÊ¥æÂè¶‰∏Ä‰∏™ÂºÇÊ≠•‰ªªÂä°Âà∞‰∏ªÈòüÂàó‰∏≠„ÄÇ self.postContentAddedNotification() &#125; &#125;&#125;//‰∏äÈù¢ÊòØËß£ÂÜ≥‰∫ÜÂÜôÂèØËÉΩÂèëÁîüÊ≠ªÈîÅÔºå‰∏ãÈù¢ÊòØ‰ΩøÁî®dispatch_syncËß£ÂÜ≥ËØªÊó∂ÂèØËÉΩ‰ºöÂèëÁîüÁöÑÊ≠ªÈîÅ„ÄÇvar photos: [Photo] &#123; var photosCopy: [Photo]! dispatch_sync(concurrentPhotoQueue) &#123; // ÂêåÊ≠•Ë∞ÉÂ∫¶Âà∞concurrentPhotoQueueÈòüÂàóÊâßË°åËØªÊìç‰Ωú photosCopy = self._photos // ‰øùÂ≠ò &#125; return photosCopy&#125;//ËøôÊ†∑ËØªÂÜôÈóÆÈ¢òÈÉΩËß£ÂÜ≥‰∫Ü„ÄÇ ÈÉΩÁî®ÂºÇÊ≠•Â§ÑÁêÜÈÅøÂÖçÊ≠ªÈîÅÔºåÂºÇÊ≠•ÁöÑÁº∫ÁÇπÂú®‰∫éË∞ÉËØï‰∏çÊñπ‰æøÔºå‰ΩÜÊòØÊØîËµ∑ÂêåÊ≠•ÂÆπÊòì‰∫ßÁîüÊ≠ªÈîÅËøô‰∏™ÂâØ‰ΩúÁî®ËøòÁÆóÂ∞èÁöÑ„ÄÇ dispatch_applyËøõË°åÂø´ÈÄüËø≠‰ª£Á±ª‰ººforÂæ™ÁéØÔºå‰ΩÜÊòØÂú®Âπ∂ÂèëÈòüÂàóÁöÑÊÉÖÂÜµ‰∏ãdispatch_apply‰ºöÂπ∂ÂèëÊâßË°åblock‰ªªÂä°„ÄÇ12345678910111213for (size_t y = 0; y &lt; height; ++y) &#123; for (size_t x = 0; x &lt; width; ++x) &#123; // Do something with x and y here &#125;&#125;//Âõ†‰∏∫ÂèØ‰ª•Âπ∂Ë°åÊâßË°åÔºåÊâÄ‰ª•‰ΩøÁî®dispatch_applyÂèØ‰ª•ËøêË°åÁöÑÊõ¥Âø´- (void)dispatchApplyDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT); dispatch_apply(10, concurrentQueue, ^(size_t i) &#123; NSLog(@&quot;%zu&quot;,i); &#125;); NSLog(@&quot;The end&quot;); //ËøôÈáåÊúâ‰∏™ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºådispatch_applyËøô‰∏™ÊòØ‰ºöÈòªÂ°û‰∏ªÁ∫øÁ®ãÁöÑ„ÄÇËøô‰∏™logÊâìÂç∞‰ºöÂú®dispatch_applyÈÉΩÁªìÊùüÂêéÊâçÂºÄÂßãÊâßË°å&#125; dispatch_applyËÉΩÈÅøÂÖçÁ∫øÁ®ãÁàÜÁÇ∏ÔºåÂõ†‰∏∫GCD‰ºöÁÆ°ÁêÜÂπ∂Âèë123456789101112131415161718- (void)dealWiththreadWithMaybeExplode:(BOOL)explode &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); if (explode) &#123; //ÊúâÈóÆÈ¢òÁöÑÊÉÖÂÜµÔºåÂèØËÉΩ‰ºöÊ≠ªÈîÅ for (int i = 0; i &lt; 999 ; i++) &#123; dispatch_async(concurrentQueue, ^&#123; NSLog(@&quot;wrong %d&quot;,i); //do something hard &#125;); &#125; &#125; else &#123; //‰ºö‰ºòÂåñÂæàÂ§öÔºåËÉΩÂ§üÂà©Áî®GCDÁÆ°ÁêÜ dispatch_apply(999, concurrentQueue, ^(size_t i)&#123; NSLog(@&quot;correct %zu&quot;,i); //do something hard &#125;); &#125;&#125; Á§∫‰æãÔºö1234567891011121314151617181920212223242526272829func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; var storedError: NSError! var downloadGroup = dispatch_group_create() let addresses = [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] dispatch_apply(UInt(addresses.count), GlobalUserInitiatedQueue) &#123; i in let index = Int(i) let address = addresses[index] let url = NSURL(string: address) dispatch_group_enter(downloadGroup) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; BlockÁªÑÂêàDispatch_groupsdispatch groupsÊòØ‰∏ìÈó®Áî®Êù•ÁõëËßÜÂ§ö‰∏™ÂºÇÊ≠•‰ªªÂä°„ÄÇdispatch_group_tÂÆû‰æãÁî®Êù•ËøΩË∏™‰∏çÂêåÈòüÂàó‰∏≠ÁöÑ‰∏çÂêå‰ªªÂä°„ÄÇ ÂΩìgroupÈáåÊâÄÊúâ‰∫ã‰ª∂ÈÉΩÂÆåÊàêGCD APIÊúâ‰∏§ÁßçÊñπÂºèÂèëÈÄÅÈÄöÁü•ÔºåÁ¨¨‰∏ÄÁßçÊòØdispatch_group_waitÔºå‰ºöÈòªÂ°ûÂΩìÂâçËøõÁ®ãÔºåÁ≠âÊâÄÊúâ‰ªªÂä°ÈÉΩÂÆåÊàêÊàñÁ≠âÂæÖË∂ÖÊó∂„ÄÇÁ¨¨‰∫åÁßçÊñπÊ≥ïÊòØ‰ΩøÁî®dispatch_group_notifyÔºåÂºÇÊ≠•ÊâßË°åÈó≠ÂåÖÔºå‰∏ç‰ºöÈòªÂ°û„ÄÇ Á¨¨‰∏ÄÁßç‰ΩøÁî®dispatch_group_waitÁöÑswiftÁöÑ‰æãÂ≠êÔºö1234567891011121314151617181920212223242526272829func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; dispatch_async(GlobalUserInitiatedQueue) &#123; // Âõ†‰∏∫dispatch_group_wait‰ºöÁßüÂ°ûÂΩìÂâçËøõÁ®ãÔºåÊâÄ‰ª•Ë¶Å‰ΩøÁî®dispatch_asyncÂ∞ÜÊï¥‰∏™ÊñπÊ≥ïË¶ÅÊîæÂà∞ÂêéÂè∞ÈòüÂàóÊâçËÉΩÂ§ü‰øùËØÅ‰∏ªÁ∫øÁ®ã‰∏çË¢´ÈòªÂ°û var storedError: NSError! var downloadGroup = dispatch_group_create() // ÂàõÂª∫‰∏Ä‰∏™dispatch group for address in [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] &#123; let url = NSURL(string: address) dispatch_group_enter(downloadGroup) // dispatch_group_enterÊòØÈÄöÁü•dispatch group‰ªªÂä°ÂºÄÂßã‰∫ÜÔºådispatch_group_enterÂíådispatch_group_leaveÊòØÊàêÂØπË∞ÉÁî®Ôºå‰∏çÁÑ∂Á®ãÂ∫èÂ∞±Â¥©Ê∫É‰∫Ü„ÄÇ let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) // ‰øùÊåÅÂíådispatch_group_enterÈÖçÂØπ„ÄÇÈÄöÁü•‰ªªÂä°Â∑≤ÁªèÂÆåÊàê &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_wait(downloadGroup, DISPATCH_TIME_FOREVER) // dispatch_group_waitÁ≠âÂæÖÊâÄÊúâ‰ªªÂä°ÈÉΩÂÆåÊàêÁõ¥Âà∞Ë∂ÖÊó∂„ÄÇÂ¶ÇÊûú‰ªªÂä°ÂÆåÊàêÂâçÂ∞±Ë∂ÖÊó∂‰∫ÜÔºåÂáΩÊï∞‰ºöËøîÂõû‰∏Ä‰∏™ÈùûÈõ∂ÂÄºÔºåÂèØ‰ª•ÈÄöËøáËøîÂõûÂÄºÂà§Êñ≠ÊòØÂê¶Ë∂ÖÊó∂„ÄÇ‰πüÂèØ‰ª•Áî®DISPATCH_TIME_FOREVERË°®Á§∫‰∏ÄÁõ¥Á≠â„ÄÇ dispatch_async(GlobalMainQueue) &#123; // ËøôÈáåÂèØ‰ª•‰øùËØÅÊâÄÊúâÂõæÁâá‰ªªÂä°ÈÉΩÂÆåÊàêÔºåÁÑ∂ÂêéÂú®main queueÈáåÂä†ÂÖ•ÂÆåÊàêÂêéË¶ÅÂ§ÑÁêÜÁöÑÈó≠ÂåÖÔºå‰ºöÂú®main queueÈáåÊâßË°å„ÄÇ if let completion = completion &#123; // ÊâßË°åÈó≠ÂåÖÂÜÖÂÆπ completion(error: storedError) &#125; &#125; &#125;&#125; oc‰æãÂ≠ê1234567891011121314- (void)dispatchGroupWaitDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); //Âú®group‰∏≠Ê∑ªÂä†ÈòüÂàóÁöÑblock dispatch_group_async(group, concurrentQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_wait(group, DISPATCH_TIME_FOREVER); NSLog(@&quot;go on&quot;);&#125; Á¨¨‰∫åÁßç‰ΩøÁî®dispatch_group_notifyÁöÑswiftÁöÑ‰æãÂ≠êÔºö123456789101112131415161718192021222324252627func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; // ‰∏çÁî®Âä†dispatch_asyncÔºåÂõ†‰∏∫Ê≤°ÊúâÈòªÂ°û‰∏ªËøõÁ®ã var storedError: NSError! var downloadGroup = dispatch_group_create() for address in [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] &#123; let url = NSURL(string: address) dispatch_group_enter(downloadGroup) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; // dispatch_group_notifyÂíådispatch_group_waitÁöÑÂå∫Âà´Â∞±ÊòØÊòØÂºÇÊ≠•ÊâßË°åÈó≠ÂåÖÁöÑÔºåÂΩìdispatch groups‰∏≠Ê≤°ÊúâÂâ©‰ΩôÁöÑ‰ªªÂä°Êó∂Èó≠ÂåÖÊâçÊâßË°å„ÄÇËøôÈáåÊòØÊåáÊòéÂú®‰∏ªÈòüÂàó‰∏≠ÊâßË°å„ÄÇ if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; oc‰æãÂ≠ê1234567891011121314151617181920212223242526272829303132//dispatch_group_notify- (void)dispatchGroupNotifyDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123; NSLog(@&quot;end&quot;); &#125;); NSLog(@&quot;can continue&quot;);&#125;//dispatch_group_wait- (void)dispatchGroupWaitDemo &#123; dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_group_t group = dispatch_group_create(); //Âú®group‰∏≠Ê∑ªÂä†ÈòüÂàóÁöÑblock dispatch_group_async(group, concurrentQueue, ^&#123; [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;1&quot;); &#125;); dispatch_group_async(group, concurrentQueue, ^&#123; NSLog(@&quot;2&quot;); &#125;); dispatch_group_wait(group, DISPATCH_TIME_FOREVER); NSLog(@&quot;can continue&quot;);&#125; Â¶Ç‰ΩïÂØπÁé∞ÊúâAPI‰ΩøÁî®dispatch_group_t12345678910111213141516171819202122232425262728293031323334//ÁªôCore DataÁöÑ-performBlock:Ê∑ªÂä†groups„ÄÇÁªÑÂêàÂÆåÊàê‰ªªÂä°Âêé‰ΩøÁî®dispatch_group_notifyÊù•ËøêË°å‰∏Ä‰∏™blockÂç≥ÂèØ„ÄÇ- (void)withGroup:(dispatch_group_t)group performBlock:(dispatch_block_t)block&#123; if (group == NULL) &#123; [self performBlock:block]; &#125; else &#123; dispatch_group_enter(group); [self performBlock:^()&#123; block(); dispatch_group_leave(group); &#125;]; &#125;&#125;//NSURLConnection‰πüÂèØ‰ª•ËøôÊ†∑ÂÅö+ (void)withGroup:(dispatch_group_t)group sendAsynchronousRequest:(NSURLRequest *)request queue:(NSOperationQueue *)queue completionHandler:(void (^)(NSURLResponse*, NSData*, NSError*))handler&#123; if (group == NULL) &#123; [self sendAsynchronousRequest:request queue:queue completionHandler:handler]; &#125; else &#123; dispatch_group_enter(group); [self sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)&#123; handler(response, data, error); dispatch_group_leave(group); &#125;]; &#125;&#125; Ê≥®ÊÑè‰∫ãÈ°π dispatch_group_asyncÁ≠â‰ª∑‰∫édispatch_group_enter() Âíå dispatch_group_leave()ÁöÑÁªÑÂêà„ÄÇ dispatch_group_enter() ÂøÖÈ°ªËøêË°åÂú® dispatch_group_leave() ‰πãÂâç„ÄÇ dispatch_group_enter() Âíå dispatch_group_leave() ÈúÄË¶ÅÊàêÂØπÂá∫Áé∞ÁöÑ Dispatch BlockÈòüÂàóÊâßË°å‰ªªÂä°ÈÉΩÊòØblockÁöÑÊñπÂºèÔºå ÂàõÂª∫block 1234567891011121314- (void)createDispatchBlock &#123; //normal way dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.starming.gcddemo.concurrentqueue&quot;,DISPATCH_QUEUE_CONCURRENT); dispatch_block_t block = dispatch_block_create(0, ^&#123; NSLog(@&quot;run block&quot;); &#125;); dispatch_async(concurrentQueue, block); //QOS way dispatch_block_t qosBlock = dispatch_block_create_with_qos_class(0, QOS_CLASS_USER_INITIATED, -1, ^&#123; NSLog(@&quot;run qos block&quot;); &#125;); dispatch_async(concurrentQueue, qosBlock);&#125; dispatch_block_waitÔºöÂèØ‰ª•Ê†πÊçÆdispatch blockÊù•ËÆæÁΩÆÁ≠âÂæÖÊó∂Èó¥ÔºåÂèÇÊï∞DISPATCH_TIME_FOREVER‰ºö‰∏ÄÁõ¥Á≠âÂæÖblockÁªìÊùü 123456789101112- (void)dispatchBlockWaitDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t block = dispatch_block_create(0, ^&#123; NSLog(@&quot;star&quot;); [NSThread sleepForTimeInterval:5.f]; NSLog(@&quot;end&quot;); &#125;); dispatch_async(serialQueue, block); //ËÆæÁΩÆDISPATCH_TIME_FOREVER‰ºö‰∏ÄÁõ¥Á≠âÂà∞ÂâçÈù¢‰ªªÂä°ÈÉΩÂÆåÊàê dispatch_block_wait(block, DISPATCH_TIME_FOREVER); NSLog(@&quot;ok, now can go on&quot;);&#125; dispatch_block_notifyÔºöÂèØ‰ª•ÁõëËßÜÊåáÂÆödispatch blockÁªìÊùüÔºåÁÑ∂ÂêéÂÜçÂä†ÂÖ•‰∏Ä‰∏™blockÂà∞ÈòüÂàó‰∏≠„ÄÇ‰∏â‰∏™ÂèÇÊï∞ÂàÜÂà´‰∏∫ÔºåÁ¨¨‰∏Ä‰∏™ÊòØÈúÄË¶ÅÁõëËßÜÁöÑblockÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÈúÄË¶ÅÊèê‰∫§ÊâßË°åÁöÑÈòüÂàóÔºåÁ¨¨‰∏â‰∏™ÊòØÂæÖÂä†ÂÖ•Âà∞ÈòüÂàó‰∏≠ÁöÑblock 1234567891011121314- (void)dispatchBlockNotifyDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t firstBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;first block start&quot;); [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;first block end&quot;); &#125;); dispatch_async(serialQueue, firstBlock); dispatch_block_t secondBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;second block run&quot;); &#125;); //first blockÊâßË°åÂÆåÊâçÂú®serial queue‰∏≠ÊâßË°åsecond block dispatch_block_notify(firstBlock, serialQueue, secondBlock);&#125; dispatch_block_cancelÔºöiOS8ÂêéGCDÊîØÊåÅÂØπdispatch blockÁöÑÂèñÊ∂à123456789101112131415- (void)dispatchBlockCancelDemo &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); dispatch_block_t firstBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;first block start&quot;); [NSThread sleepForTimeInterval:2.f]; NSLog(@&quot;first block end&quot;); &#125;); dispatch_block_t secondBlock = dispatch_block_create(0, ^&#123; NSLog(@&quot;second block run&quot;); &#125;); dispatch_async(serialQueue, firstBlock); dispatch_async(serialQueue, secondBlock); //ÂèñÊ∂àsecondBlock dispatch_block_cancel(secondBlock);&#125; ‰ΩøÁî®dispatch block objectÔºàË∞ÉÂ∫¶ÂùóÔºâÂú®‰ªªÂä°ÊâßË°åÂâçËøõË°åÂèñÊ∂àdispatch block objectÂèØ‰ª•‰∏∫ÈòüÂàó‰∏≠ÁöÑÂØπË±°ËÆæÁΩÆ Á§∫‰æãÔºå‰∏ãËΩΩÂõæÁâá‰∏≠ÈÄîËøõË°åÂèñÊ∂à123456789101112131415161718192021222324252627282930313233343536373839404142func downloadPhotosWithCompletion(completion: BatchPhotoDownloadingCompletionClosure?) &#123; var storedError: NSError! let downloadGroup = dispatch_group_create() var addresses = [OverlyAttachedGirlfriendURLString, SuccessKidURLString, LotsOfFacesURLString] addresses += addresses + addresses // Êâ©Â±ïaddressÊï∞ÁªÑÔºåÂ§çÂà∂3‰ªΩ var blocks: [dispatch_block_t] = [] // ‰∏Ä‰∏™‰øùÂ≠òblockÁöÑÊï∞ÁªÑ for i in 0 ..&lt; addresses.count &#123; dispatch_group_enter(downloadGroup) let block = dispatch_block_create(DISPATCH_BLOCK_INHERIT_QOS_CLASS) &#123; // ÂàõÂª∫‰∏Ä‰∏™blockÔºåblockÁöÑÊ†áÂøóÊòØDISPATCH_BLOCK_INHERIT_QOS_CLASS let index = Int(i) let address = addresses[index] let url = NSURL(string: address) let photo = DownloadPhoto(url: url!) &#123; image, error in if let error = error &#123; storedError = error &#125; dispatch_group_leave(downloadGroup) &#125; PhotoManager.sharedManager.addPhoto(photo) &#125; blocks.append(block) dispatch_async(GlobalMainQueue, block) // ÊääËøô‰∏™blockÊîæÂà∞GlobalMainQueue‰∏äÂºÇÊ≠•Ë∞ÉÁî®„ÄÇÂõ†‰∏∫ÂÖ®Â±ÄÈòüÂàóÊòØ‰∏Ä‰∏™È°∫Â∫èÈòüÂàóÊâÄ‰ª•Êñπ‰æøÂèñÊ∂àÂØπË±°blockÔºåÂêåÊó∂ÂèØ‰ª•‰øùËØÅ‰∏ãËΩΩ‰ªªÂä°Âú®downloadPhotosWithCompletionËøîÂõûÂêéÊâçÂºÄÂßãÊâßË°å„ÄÇ &#125; for block in blocks[3 ..&lt; blocks.count] &#123; let cancel = arc4random_uniform(2) // ÈöèÊú∫ËøîÂõû‰∏Ä‰∏™Êï¥Êï∞Ôºå‰ºöËøîÂõû0Êàñ1 if cancel == 1 &#123; dispatch_block_cancel(block) // Â¶ÇÊûúÊòØ1Â∞±ÂèñÊ∂àblockÔºåËøô‰∏™Âè™ËÉΩÂèëÁîüÂú®blockËøòÂú®ÈòüÂàó‰∏≠Âπ∂Ê≤°ÊúâÂºÄÂßãÁöÑÊÉÖÂÜµ‰∏ã„ÄÇÂõ†‰∏∫ÊääblockÂ∑≤ÁªèÊîæÂà∞‰∫ÜGlobalMainQueue‰∏≠ÔºåÊâÄ‰ª•Ëøô‰∏™Âú∞Êñπ‰ºöÂÖàÊâßË°åÔºåÊâßË°åÂÆå‰∫ÜÊâç‰ºöÊâßË°åblock„ÄÇ dispatch_group_leave(downloadGroup) // Âõ†‰∏∫Â∑≤Áªèdispatch_group_enter‰∫ÜÔºåÊâÄ‰ª•ÂèñÊ∂àÊó∂‰πüË¶ÅÂ∞ÜÂÖ∂ÈÉΩleaveÊéâ„ÄÇ &#125; &#125; dispatch_group_notify(downloadGroup, GlobalMainQueue) &#123; if let completion = completion &#123; completion(error: storedError) &#125; &#125;&#125; Dispatch IO Êñá‰ª∂Êìç‰Ωúdispatch ioËØªÂèñÊñá‰ª∂ÁöÑÊñπÂºèÁ±ª‰ºº‰∫é‰∏ãÈù¢ÁöÑÊñπÂºèÔºåÂ§ö‰∏™Á∫øÁ®ãÂéªËØªÂèñÊñá‰ª∂ÁöÑÂàáÁâáÊï∞ÊçÆÔºåÂØπ‰∫éÂ§ßÁöÑÊï∞ÊçÆÊñá‰ª∂ËøôÊ†∑‰ºöÊØîÂçïÁ∫øÁ®ãË¶ÅÂø´ÂæàÂ§ö„ÄÇ123dispatch_async(queue,^&#123;/*read 0-99 bytes*/&#125;);dispatch_async(queue,^&#123;/*read 100-199 bytes*/&#125;);dispatch_async(queue,^&#123;/*read 200-299 bytes*/&#125;); dispatch_io_createÔºöÂàõÂª∫dispatch io dispatch_io_set_low_waterÔºöÊåáÂÆöÂàáÂâ≤Êñá‰ª∂Â§ßÂ∞è dispatch_io_readÔºöËØªÂèñÂàáÂâ≤ÁöÑÊñá‰ª∂ÁÑ∂ÂêéÂêàÂπ∂„ÄÇËãπÊûúÁ≥ªÁªüÊó•ÂøóAPIÈáåÁî®Âà∞‰∫ÜËøô‰∏™ÊäÄÊúØÔºåÂèØ‰ª•Âú®ËøôÈáåÊü•ÁúãÔºöhttps://github.com/Apple-FOSS-Mirror/Libc/blob/2ca2ae74647714acfc18674c3114b1a5d3325d7d/gen/asl.c 12345678910111213141516171819202122232425262728293031323334353637383940pipe_q = dispatch_queue_create(&quot;PipeQ&quot;, NULL);//ÂàõÂª∫pipe_channel = dispatch_io_create(DISPATCH_IO_STREAM, fd, pipe_q, ^(int err)&#123; close(fd);&#125;);*out_fd = fdpair[1];//ËÆæÁΩÆÂàáÂâ≤Â§ßÂ∞èdispatch_io_set_low_water(pipe_channel, SIZE_MAX);dispatch_io_read(pipe_channel, 0, SIZE_MAX, pipe_q, ^(bool done, dispatch_data_t pipedata, int err)&#123; if (err == 0) &#123; size_t len = dispatch_data_get_size(pipedata); if (len &gt; 0) &#123; //ÂØπÊØèÊ¨°ÂàáÂùóÊï∞ÊçÆÁöÑÂ§ÑÁêÜ const char *bytes = NULL; char *encoded; uint32_t eval; dispatch_data_t md = dispatch_data_create_map(pipedata, (const void **)&amp;bytes, &amp;len); encoded = asl_core_encode_buffer(bytes, len); asl_msg_set_key_val(aux, ASL_KEY_AUX_DATA, encoded); free(encoded); eval = _asl_evaluate_send(NULL, (aslmsg)aux, -1); _asl_send_message(NULL, eval, aux, NULL); asl_msg_release(aux); dispatch_release(md); &#125; &#125; if (done) &#123; //semaphore +1‰ΩøÂæó‰∏çÈúÄË¶ÅÂÜçÁ≠âÂæÖÁªßÁª≠ÊâßË°å‰∏ãÂéª„ÄÇ dispatch_semaphore_signal(sem); dispatch_release(pipe_channel); dispatch_release(pipe_q); &#125;&#125;); Dispatch Source Áî®GCDÁõëËßÜËøõÁ®ãDispatch SourceÁî®‰∫éÁõëÂê¨Á≥ªÁªüÁöÑÂ∫ïÂ±ÇÂØπË±°ÔºåÊØîÂ¶ÇÊñá‰ª∂ÊèèËø∞Á¨¶ÔºåMachÁ´ØÂè£Ôºå‰ø°Âè∑ÈáèÁ≠â„ÄÇ‰∏ªË¶ÅÂ§ÑÁêÜÁöÑ‰∫ã‰ª∂Â¶Ç‰∏ãË°® ÊñπÊ≥ï ËØ¥Êòé DISPATCH_SOURCE_TYPE_DATA_ADD Êï∞ÊçÆÂ¢ûÂä† DISPATCH_SOURCE_TYPE_DATA_OR Êï∞ÊçÆOR DISPATCH_SOURCE_TYPE_MACH_RECV MachÁ´ØÂè£Êé•Êî∂ DISPATCH_SOURCE_TYPE_MEMORYPRESSURE ÂÜÖÂ≠òÊÉÖÂÜµ DISPATCH_SOURCE_TYPE_READ ËØªÊï∞ÊçÆ DISPATCH_SOURCE_TYPE_SIGNAL ‰ø°Âè∑ DISPATCH_SOURCE_TYPE_TIMER ÂÆöÊó∂Âô® DISPATCH_SOURCE_TYPE_VNODE Êñá‰ª∂Á≥ªÁªüÂèòÂåñ DISPATCH_SOURCE_TYPE_WRITE Êñá‰ª∂ÂÜôÂÖ• ÊñπÊ≥ï dispatch_source_createÔºöÂàõÂª∫dispatch sourceÔºåÂàõÂª∫Âêé‰ºöÂ§Ñ‰∫éÊåÇËµ∑Áä∂ÊÄÅËøõË°å‰∫ã‰ª∂Êé•Êî∂ÔºåÈúÄË¶ÅËÆæÁΩÆ‰∫ã‰ª∂Â§ÑÁêÜhandlerËøõË°å‰∫ã‰ª∂Â§ÑÁêÜ„ÄÇ dispatch_source_set_event_handlerÔºöËÆæÁΩÆ‰∫ã‰ª∂Â§ÑÁêÜhandler dispatch_source_set_cancel_handlerÔºö‰∫ã‰ª∂ÂèñÊ∂àhandlerÔºåÂ∞±ÊòØÂú®dispatch sourceÈáäÊîæÂâçÂÅö‰∫õÊ∏ÖÁêÜÁöÑ‰∫ã„ÄÇ dispatch_source_cancelÔºöÂÖ≥Èó≠dispatch sourceÔºåËÆæÁΩÆÁöÑ‰∫ã‰ª∂Â§ÑÁêÜhandler‰∏ç‰ºöË¢´ÊâßË°åÔºåÂ∑≤ÁªèÊâßË°åÁöÑ‰∫ã‰ª∂handler‰∏ç‰ºöÂèñÊ∂à„ÄÇ 1234567891011NSRunningApplication *mail = [NSRunningApplication runningApplicationsWithBundleIdentifier:@&quot;com.apple.mail&quot;];if (mail == nil) &#123; return;&#125;pid_t const pid = mail.processIdentifier;self.source = dispatch_source_create(DISPATCH_SOURCE_TYPE_PROC, pid, DISPATCH_PROC_EXIT, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(self.source, ^()&#123; NSLog(@&quot;Mail quit.&quot;);&#125;);//Âú®‰∫ã‰ª∂Ê∫ê‰º†Âà∞‰Ω†ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÂâçÈúÄË¶ÅË∞ÉÁî®dispatch_resume()Ëøô‰∏™ÊñπÊ≥ïdispatch_resume(self.source); ÁõëËßÜÊñá‰ª∂Â§πÂÜÖÊñá‰ª∂ÂèòÂåñ12345678910111213141516171819202122232425NSURL *directoryURL; // assume this is set to a directoryint const fd = open([[directoryURL path] fileSystemRepresentation], O_EVTONLY);if (fd &lt; 0) &#123; char buffer[80]; strerror_r(errno, buffer, sizeof(buffer)); NSLog(@&quot;Unable to open \&quot;%@\&quot;: %s (%d)&quot;, [directoryURL path], buffer, errno); return;&#125;dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_VNODE, fd,DISPATCH_VNODE_WRITE | DISPATCH_VNODE_DELETE, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(source, ^()&#123; unsigned long const data = dispatch_source_get_data(source); if (data &amp; DISPATCH_VNODE_WRITE) &#123; NSLog(@&quot;The directory changed.&quot;); &#125; if (data &amp; DISPATCH_VNODE_DELETE) &#123; NSLog(@&quot;The directory has been deleted.&quot;); &#125;&#125;);dispatch_source_set_cancel_handler(source, ^()&#123; close(fd);&#125;);self.source = source;dispatch_resume(self.source);//ËøòË¶ÅÊ≥®ÊÑèÈúÄË¶ÅÁî®DISPATCH_VNODE_DELETE ÂéªÊ£ÄÊü•ÁõëËßÜÁöÑÊñá‰ª∂ÊàñÊñá‰ª∂Â§πÊòØÂê¶Ë¢´Âà†Èô§ÔºåÂ¶ÇÊûúÂà†Èô§‰∫ÜÂ∞±ÂÅúÊ≠¢ÁõëÂê¨ NSTimerÂú®‰∏ªÁ∫øÁ®ãÁöÑrunloopÈáå‰ºöÂú®runloopÂàáÊç¢ÂÖ∂ÂÆÉÊ®°ÂºèÊó∂ÂÅúÊ≠¢ÔºåËøôÊó∂Â∞±ÈúÄË¶ÅÊâãÂä®Âú®Â≠êÁ∫øÁ®ãÂºÄÂêØ‰∏Ä‰∏™Ê®°Âºè‰∏∫NSRunLoopCommonModesÁöÑrunloopÔºåÂ¶ÇÊûú‰∏çÊÉ≥ÂºÄÂêØ‰∏Ä‰∏™Êñ∞ÁöÑrunloopÂèØ‰ª•Áî®‰∏çË∑ürunloopÂÖ≥ËÅîÁöÑdispatch source timerÔºåÂ¶Ç‰∏ã„ÄÇ12345678dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,0, 0, DISPATCH_TARGET_QUEUE_DEFAULT);dispatch_source_set_event_handler(source, ^()&#123; NSLog(@&quot;Time flies.&quot;);&#125;);dispatch_time_t startdispatch_source_set_timer(source, DISPATCH_TIME_NOW, 5ull * NSEC_PER_SEC,100ull * NSEC_PER_MSEC);self.source = source;dispatch_resume(self.source); Dispatch SemaphoreÂíåÁöÑ‰ªãÁªçÂè¶Â§ñ‰∏ÄÁßç‰øùËØÅÂêåÊ≠•ÁöÑÊñπÊ≥ï„ÄÇ‰ΩøÁî®dispatch_semaphore_signalÂä†1dispatch_semaphore_waitÂáè1Ôºå‰∏∫0Êó∂Á≠âÂæÖÁöÑËÆæÁΩÆÊñπÂºèÊù•ËææÂà∞Á∫øÁ®ãÂêåÊ≠•ÁöÑÁõÆÁöÑÂíåÂêåÊ≠•ÈîÅ‰∏ÄÊ†∑ËÉΩÂ§üËß£ÂÜ≥ËµÑÊ∫êÊä¢Âç†ÁöÑÈóÆÈ¢ò„ÄÇ12345678910111213//dispatch semaphore- (void)dispatchSemaphoreDemo &#123; //ÂàõÂª∫semaphore dispatch_semaphore_t semaphore = dispatch_semaphore_create(0); dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSLog(@&quot;start&quot;); [NSThread sleepForTimeInterval:1.f]; NSLog(@&quot;semaphore +1&quot;); dispatch_semaphore_signal(semaphore); //+1 semaphore &#125;); dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER); NSLog(@&quot;continue&quot;);&#125; ÈîÅËøôÈáåÁÆÄÂçï‰ªãÁªç‰∏ãiOS‰∏≠Â∏∏Áî®ÁöÑÂêÑÁßçÈîÅÂíå‰ªñ‰ª¨ÁöÑÊÄßËÉΩ„ÄÇ NSRecursiveLockÔºöÈÄíÂΩíÈîÅÔºåÂèØ‰ª•Âú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÂèçÂ§çËé∑ÂèñÈîÅ‰∏ç‰ºöÈÄ†ÊàêÊ≠ªÈîÅÔºåËøô‰∏™ËøáÁ®ã‰ºöËÆ∞ÂΩïËé∑ÂèñÈîÅÂíåÈáäÊîæÈîÅÁöÑÊ¨°Êï∞Êù•ËææÂà∞‰ΩïÊó∂ÈáäÊîæÁöÑ‰ΩúÁî®„ÄÇ NSDistributedLockÔºöÂàÜÂ∏ÉÈîÅÔºåÂü∫‰∫éÊñá‰ª∂ÊñπÂºèÁöÑÈîÅÊú∫Âà∂ÔºåÂèØ‰ª•Ë∑®ËøõÁ®ãËÆøÈóÆ„ÄÇ NSConditionLockÔºöÊù°‰ª∂ÈîÅÔºåÁî®Êà∑ÂÆö‰πâÊù°‰ª∂ÔºåÁ°Æ‰øù‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•Ëé∑ÂèñÊª°Ë∂≥‰∏ÄÂÆöÊù°‰ª∂ÁöÑÈîÅ„ÄÇÂõ†‰∏∫Á∫øÁ®ãÈó¥Á´û‰∫â‰ºöÊ∂âÂèäÂà∞Êù°‰ª∂ÈîÅÊ£ÄÊµãÔºåÁ≥ªÁªüË∞ÉÁî®‰∏ä‰∏ãÂàáÊç¢È¢ëÁπÅÂØºËá¥ËÄóÊó∂ÊòØÂá†‰∏™ÈîÅÈáåÊúÄÈïøÁöÑ„ÄÇ OSSpinLockÔºöËá™ÊóãÈîÅÔºå‰∏çËøõÂÖ•ÂÜÖÊ†∏ÔºåÂáèÂ∞ë‰∏ä‰∏ãÊñáÂàáÊç¢ÔºåÊÄßËÉΩÊúÄÈ´òÔºå‰ΩÜÊä¢Âç†Â§öÊó∂‰ºöÂç†Áî®ËæÉÂ§öcpuÔºåÂ•ΩÁÇπÂ§öÔºåËøôÊó∂‰ΩøÁî®pthread_mutexËæÉÂ•Ω„ÄÇ pthread_mutex_tÔºöÂêåÊ≠•ÈîÅÂü∫‰∫éCËØ≠Ë®ÄÔºåÂ∫ïÂ±ÇapiÊÄßËÉΩÈ´òÔºå‰ΩøÁî®ÊñπÊ≥ïÂíåÂÖ∂ÂÆÉÁöÑÁ±ª‰ºº„ÄÇ @synchronizedÔºöÊõ¥Âä†ÁÆÄÂçï„ÄÇ dispatch_suspendÂíådispatch_resumeÊåÇËµ∑ÂíåÊÅ¢Â§çÈòüÂàódispatch_suspendËøôÈáåÊåÇËµ∑‰∏ç‰ºöÊöÇÂÅúÊ≠£Âú®ÊâßË°åÁöÑblockÔºåÂè™ÊòØËÉΩÂ§üÊöÇÂÅúËøòÊ≤°ÊâßË°åÁöÑblock„ÄÇ dispatch_set_contextÂíådispatch_get_contextGCDÊ∑±ÂÖ•Êìç‰ΩúÁºìÂÜ≤Âå∫Ôºödispatch_data_tÂü∫‰∫éÈõ∂Á¢éÁöÑÂÜÖÂ≠òÂå∫ÂüüÔºå‰ΩøÁî®dispatch_data_applyÊù•ÈÅçÂéÜÔºåËøòÂèØ‰ª•Áî®dispatch_data_create_subrangeÊù•ÂàõÂª∫‰∏Ä‰∏™‰∏çÂÅö‰ªª‰ΩïÊã∑Ë¥ùÁöÑÂ≠êÂå∫ÂüüI/OË∞ÉÂ∫¶Ôºö‰ΩøÁî®GCDÊèê‰æõÁöÑdispatch_io_readÔºådispatch_io_writeÂíådispatch_io_closeÊµãËØïÔºö‰ΩøÁî®dispatch_benchmarkÂ∞èÂ∑•ÂÖ∑ÂéüÂ≠êÊìç‰ΩúÔºö libkern/OSAtomic.hÈáåÂèØ‰ª•Êü•ÁúãÈÇ£‰∫õÂáΩÊï∞ÔºåÁî®‰∫éÂ∫ïÂ±ÇÂ§öÁ∫øÁ®ãÁºñÁ®ã„ÄÇ GCDÊ≠ªÈîÅÂΩìÂâç‰∏≤Ë°åÈòüÂàóÈáåÈù¢ÂêåÊ≠•ÊâßË°åÂΩìÂâç‰∏≤Ë°åÈòüÂàóÂ∞±‰ºöÊ≠ªÈîÅÔºåËß£ÂÜ≥ÁöÑÊñπÊ≥ïÂ∞±ÊòØÂ∞ÜÂêåÊ≠•ÁöÑ‰∏≤Ë°åÈòüÂàóÊîæÂà∞Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÂ∞±ËÉΩÂ§üËß£ÂÜ≥„ÄÇ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556- (void)deadLockCase1 &#123; NSLog(@&quot;1&quot;); //‰∏ªÈòüÂàóÁöÑÂêåÊ≠•Á∫øÁ®ãÔºåÊåâÁÖßFIFOÁöÑÂéüÂàôÔºàÂÖàÂÖ•ÂÖàÂá∫ÔºâÔºå2ÊéíÂú®3ÂêéÈù¢‰ºöÁ≠â3ÊâßË°åÂÆåÔºå‰ΩÜÂõ†‰∏∫ÂêåÊ≠•Á∫øÁ®ãÔºå3ÂèàË¶ÅÁ≠â2ÊâßË°åÂÆåÔºåÁõ∏‰∫íÁ≠âÂæÖÊàê‰∏∫Ê≠ªÈîÅ„ÄÇ dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;);&#125;- (void)deadLockCase2 &#123; NSLog(@&quot;1&quot;); //3‰ºöÁ≠â2ÔºåÂõ†‰∏∫2Âú®ÂÖ®Â±ÄÂπ∂Ë°åÈòüÂàóÈáåÔºå‰∏çÈúÄË¶ÅÁ≠âÂæÖ3ÔºåËøôÊ†∑2ÊâßË°åÂÆåÂõûÂà∞‰∏ªÈòüÂàóÔºå3Â∞±ÂºÄÂßãÊâßË°å dispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;);&#125;- (void)deadLockCase3 &#123; dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.starming.gcddemo.serialqueue&quot;, DISPATCH_QUEUE_SERIAL); NSLog(@&quot;1&quot;); dispatch_async(serialQueue, ^&#123; NSLog(@&quot;2&quot;); //‰∏≤Ë°åÈòüÂàóÈáåÈù¢ÂêåÊ≠•‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÂ∞±‰ºöÊ≠ªÈîÅ dispatch_sync(serialQueue, ^&#123; NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); &#125;); NSLog(@&quot;5&quot;);&#125;- (void)deadLockCase4 &#123; NSLog(@&quot;1&quot;); dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; NSLog(@&quot;2&quot;); //Â∞ÜÂêåÊ≠•ÁöÑ‰∏≤Ë°åÈòüÂàóÊîæÂà∞Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÂ∞±ËÉΩÂ§üËß£ÂÜ≥ dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); &#125;); NSLog(@&quot;5&quot;);&#125;- (void)deadLockCase5 &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; NSLog(@&quot;1&quot;); //ÂõûÂà∞‰∏ªÁ∫øÁ®ãÂèëÁé∞Ê≠ªÂæ™ÁéØÂêéÈù¢Â∞±Ê≤°Ê≥ïÊâßË°å‰∫Ü dispatch_sync(dispatch_get_main_queue(), ^&#123; NSLog(@&quot;2&quot;); &#125;); NSLog(@&quot;3&quot;); &#125;); NSLog(@&quot;4&quot;); //Ê≠ªÂæ™ÁéØ while (1) &#123; // &#125;&#125; GCDÂÆûÈôÖ‰ΩøÁî®FMDBÂ¶Ç‰Ωï‰ΩøÁî®dispatch_queue_set_specificÂíådispatch_get_specificÊù•Èò≤Ê≠¢Ê≠ªÈîÅ‰ΩúÁî®Á±ª‰ººobjc_setAssociatedObjectË∑üobjc_getAssociatedObject1234567891011static const void * const kDispatchQueueSpecificKey = &amp;kDispatchQueueSpecificKey;//ÂàõÂª∫‰∏≤Ë°åÈòüÂàóÔºåÊâÄÊúâÊï∞ÊçÆÂ∫ìÁöÑÊìç‰ΩúÈÉΩÂú®Ëøô‰∏™ÈòüÂàóÈáå_queue = dispatch_queue_create([[NSString stringWithFormat:@&quot;fmdb.%@&quot;, self] UTF8String], NULL);//Ê†áËÆ∞ÈòüÂàódispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge void *)self, NULL);//Ê£ÄÊü•ÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™ÈòüÂàóÊù•ÈÅøÂÖçÊ≠ªÈîÅÁöÑÊñπÊ≥ï- (void)inDatabase:(void (^)(FMDatabase *db))block &#123; FMDatabaseQueue *currentSyncQueue = (__bridge id)dispatch_get_specific(kDispatchQueueSpecificKey); assert(currentSyncQueue != self &amp;&amp; &quot;inDatabase: was called reentrantly on the same queue, which would lead to a deadlock&quot;);&#125; DTCoreText‰ΩøÁî®GCDÂä†Âø´Ëß£ÊûêÈÄüÂ∫¶DTCoreTextÈááÁî®ÁöÑÊòØSAXËß£ÊûêÔºåiOSËá™Â∏¶‰∫ÜXML/HTMLÁöÑËß£ÊûêÂºïÊìélibxmlÔºåÊèê‰æõ‰∫Ü‰∏§‰∏™Ëß£ÊûêÊé•Âè£ÔºåDOMËß£ÊûêÂíåSAXËß£ÊûêÔºåÂâçËÄÖ‰ΩøÁî®ÁÆÄÂçï‰ΩÜÊòØÂç†Áî®ÂÜÖÂ≠òÂ§öÔºåSAXËß£ÊûêÁî±‰∫é‰∏ç‰ºöËøîÂõû‰∏Ä‰∏™domÊ†ëÔºåÈááÁî®ÁöÑÊòØÊü•Âà∞‰∏Ä‰∏™Ê†áÁ≠æÊØîÂ¶ÇÂõûË∞ÉstartElementÊñπÊ≥ïÁ¢∞Âà∞ÂÜÖÂÆπÂ∞±ÂõûË∞É_charactersÁ¢∞Âà∞Á±ª‰ººÂ∞±ÂõûË∞ÉendElementËøôÊ†∑ÁöÑÊñπÂºè„ÄÇ Ê†πÊçÆËøôÁßçËß£ÊûêÊñπÂºèDTCoreText‰ΩøÁî®Â§öÁ∫øÁ®ãËß£ÊûêËÉΩÂ§üÊõ¥Âø´ÁöÑËß£ÊûêÔºåDTHTMLAttributedStringBuilder‰ΩøÁî®‰∏â‰∏™dispatch_queue _dataParsingQueueÔºöËß£ÊûêhtmlÁöÑ _treeBuildingQueueÔºöÁîüÊàêdomÊ†ëÁöÑ _stringAssemblyQueueÔºöÁªÑË£ÖNSAttributeStringÁöÑ Ëé∑Âèñ‰∏â‰∏™ÈòüÂàóÂÖ®ÈÉ®ÂÆåÊàêÈááÁî®‰∫Üdispatch_groupÁöÑdispatch_group_waitËøôÁßçÈòªÂ°ûÂêåÊ≠•ÊñπÂºèÊù•ËøîÂõûÁªìÊûú„ÄÇ iOSÁ≥ªÁªüÁâàÊú¨Êñ∞ÁâπÊÄßiOS8Êñ∞Âä†‰∫Ü‰∏Ä‰∏™ÂäüËÉΩÂè´Quality of Service(QoS)ÔºåÈáåÈù¢Êèê‰æõ‰∫Ü‰∏Ä‰∏ãÂá†‰∏™Êõ¥ÂÆπÊòìÁêÜËß£ÁöÑÊûö‰∏æÂêçÊù•‰ΩøÁî®user interactiveÔºåuser initiatedÔºåutilityÂíåbackground„ÄÇ‰∏ãÈù¢ÁöÑË°®ÂÅö‰∫ÜÂØπÊØî Global queue Corresponding QoS class ËØ¥Êòé Main thread NSQualityOfServiceUserInteractive UIÁõ∏ÂÖ≥Ôºå‰∫§‰∫íÁ≠â DISPATCH_QUEUE_PRIORITY_HIGH NSQualityOfServiceUserInitiated Áî®Êà∑ÂèëËµ∑ÈúÄË¶ÅÈ©¨‰∏äÂæóÂà∞ÁªìÊûúËøõË°åÂêéÁª≠‰ªªÂä° DISPATCH_QUEUE_PRIORITY_DEFAULT NSQualityOfServiceDefault ÈªòËÆ§ÁöÑ‰∏çÂ∫îËØ•‰ΩøÁî®Ëøô‰∏™ËÆæÁΩÆ‰ªªÂä° DISPATCH_QUEUE_PRIORITY_LOW NSQualityOfServiceUtility Ëä±Ë¥πÊó∂Èó¥Á®çÂ§öÊØîÂ¶Ç‰∏ãËΩΩÔºåÈúÄË¶ÅÂá†ÁßíÊàñÂá†ÂàÜÈíüÁöÑ DISPATCH_QUEUE_PRIORITY_BACKGROUND NSQualityOfServiceBackground ‰∏çÂèØËßÅÂú®ÂêéÂè∞ÁöÑÊìç‰ΩúÂèØËÉΩÈúÄË¶ÅÂ•ΩÂá†ÂàÜÈíüÁîöËá≥Âá†Â∞èÊó∂ÁöÑ]]></content>
      <tags>
        <tag>GCD (Objective-CÈ´òÁ∫ßÁºñÁ®ãÔºöiOS‰∏éOS XÂ§öÁ∫øÁ®ãÂíåÂÜÖÂ≠òÁÆ°ÁêÜ)</tag>
      </tags>
  </entry>
</search>
